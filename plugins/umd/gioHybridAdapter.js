!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";var e,i=function(){return i=Object.assign||function(e){for(var i,n=1,r=arguments.length;r>n;n++)for(var t in i=arguments[n])({}).hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e},i.apply(this,arguments)},n=function(e){return o(["undefined","null"],c(e))},r=function(e){return"object"===c(e)&&!n(e)},t=function(e){return Array.isArray(e)&&"array"===c(e)},o=function(e,i){return("array"===c(e)||"string"===c(e))&&e.indexOf(i)>=0},d=function(e){return n(e)?"":"".concat(e)},a=function(e){return r(e)?Object.keys(e):[]},s=function(e,i){a(e).forEach((function(n){return i(e[n],n)}))},u=function(e,i){if(!r(e))return!1;try{return"string"===c(i)?delete e[i]:"array"===c(i)?i.map((function(i){return delete e[i]})):(function(e){return"regexp"===c(e)}(i)&&a(e).forEach((function(n){i.test(n)&&u(e,n)})),!0)}catch(e){return!1}},c=function(e){return{}.toString.call(e).slice(8,-1).toLowerCase()},w=function(e){try{return e()}catch(e){return}},f=["VIEW_CLICK","VIEW_CHANGE","FORM_SUBMIT","PAGE","CUSTOM","LOGIN_USER_ATTRIBUTES"],g=["LOGIN_USER_ATTRIBUTES"];window.gioHybridAdapter={name:"gioHybridAdapter",method:function(n){var a=this;this.growingIO=n,this.penetrateHybrid=!0,this.onOptionsInit=function(){var e,i=a.growingIO,n=i.vdsConfig,r=i.emitter;e=n.penetrateHybrid,"boolean"===c(e)&&(a.penetrateHybrid=n.penetrateHybrid),a._initHybridBridge()&&(a.onSendBefore=a.sendBeforeListener,a.hybridConfig.projectId===a.growingIO.vdsConfig.projectId&&(a.growingIO.useHybridInherit=!0)),a.growingIO.useHybridInherit&&(null==r||r.on("SET_USERID",(function(e){var i=e.newUserId,n=e.oldUserId,r=e.userKey;a.penetrateHybrid&&(!i&&n?r?a._clearNativeUserIdAndUserKey():a._clearNativeUserId():r?a._setNativeUserIdAndUserKey(d(i),d(r)):a._setNativeUserId(d(i)))})),null==r||r.on("SET_USERKEY",(function(e){var i=e.newUserKey,n=e.oldUserKey,r=e.userId;a.penetrateHybrid&&(!i&&n?a._clearNativeUserIdAndUserKey():a._setNativeUserIdAndUserKey(d(r),d(i)))})))},this._initHybridBridge=function(){var i,n,r,t=!1;return a.hasHybridBridge=!!window.GrowingWebViewJavascriptBridge,a.hasHybridBridge?((null===(i=null===window||void 0===window?void 0:window.GrowingWebViewJavascriptBridge)||void 0===i?void 0:i.configuration)||(window.GrowingWebViewJavascriptBridge.configuration=JSON.parse(window.GrowingWebViewJavascriptBridge.getConfiguration())),(null===(n=null===window||void 0===window?void 0:window.GrowingWebViewJavascriptBridge)||void 0===n?void 0:n.configuration)&&(a.hybridConfig=null===(r=null===window||void 0===window?void 0:window.GrowingWebViewJavascriptBridge)||void 0===r?void 0:r.configuration),t=!0):e.consoleText("gioHybridAdapter：当前不存在 GrowingWebViewJavascriptBridge，Web模式。","info"),t},this.sendBeforeListener=function(e){var n=e.requestData;if(a.hasHybridBridge){var r=a.processAttributes(i({},n));o(f,r.eventType)&&(o(g,r.eventType)?a.penetrateHybrid&&a._dispatchEvent(r):(a.penetrateHybrid||u(r,["userId","userKey","cs1"]),a._dispatchEvent(r)))}},this.processAttributes=function(e){return s(e,(function(i,n){r(i)||t(i)?s(e[n],(function(i,o){r(i)||t(i)?e[n][o]=JSON.stringify(i):e[n][o]=d(i)})):e[n]=d(i)})),e},this._setNativeUserId=function(e){w((function(){return window.GrowingWebViewJavascriptBridge.setNativeUserId(e)}))},this._clearNativeUserId=function(){w((function(){return window.GrowingWebViewJavascriptBridge.clearNativeUserId()}))},this._setNativeUserIdAndUserKey=function(e,i){w((function(){return window.GrowingWebViewJavascriptBridge.setNativeUserIdAndUserKey(e,i)}))},this._clearNativeUserIdAndUserKey=function(){w((function(){return window.GrowingWebViewJavascriptBridge.clearNativeUserIdAndUserKey()}))},this._dispatchEvent=function(e){w((function(){var i;return null===(i=window.GrowingWebViewJavascriptBridge)||void 0===i?void 0:i.dispatchEvent(JSON.stringify(e))}))};var v=this.growingIO,y=v.emitter,I=v.utils;e=I,y.on("OPTION_INITIALIZED",this.onOptionsInit)}}}));
