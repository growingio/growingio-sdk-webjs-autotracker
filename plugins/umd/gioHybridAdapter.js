!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";var e=function(){return e=Object.assign||function(e){for(var i,r=1,n=arguments.length;n>r;r++)for(var t in i=arguments[r])({}).hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e},e.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError;var i,r=function(e){return o(["undefined","null"],c(e))},n=function(e){return"object"===c(e)&&!r(e)},t=function(e){return Array.isArray(e)&&"array"===c(e)},o=function(e,i){return("array"===c(e)||"string"===c(e))&&e.indexOf(i)>=0},d=function(e){return r(e)?"":"".concat(e)},s=function(e){return n(e)?Object.keys(e):[]},a=function(e,i){s(e).forEach((function(r){return i(e[r],r)}))},u=function(e,i){if(!n(e))return!1;try{return"string"===c(i)?delete e[i]:"array"===c(i)?i.map((function(i){return delete e[i]})):(function(e){return"regexp"===c(e)}(i)&&s(e).forEach((function(r){i.test(r)&&u(e,r)})),!0)}catch(e){return!1}},c=function(e){return{}.toString.call(e).slice(8,-1).toLowerCase()},w=function(e){try{return e()}catch(e){return}},f=["VIEW_CLICK","VIEW_CHANGE","FORM_SUBMIT","PAGE","CUSTOM","LOGIN_USER_ATTRIBUTES"],g=["LOGIN_USER_ATTRIBUTES"];window.gioHybridAdapter={name:"gioHybridAdapter",method:function(r){var s=this;this.growingIO=r,this.penetrateHybrid=!0,this.onOptionsInit=function(){var e,i=s.growingIO,r=i.vdsConfig,n=i.emitter;e=r.penetrateHybrid,"boolean"===c(e)&&(s.penetrateHybrid=r.penetrateHybrid),s._initHybridBridge()&&(s.onSendBefore=s.sendBeforeListener,s.hybridConfig.projectId===s.growingIO.vdsConfig.projectId&&(s.growingIO.useHybridInherit=!0)),s.growingIO.useHybridInherit&&(null==n||n.on("SET_USERID",(function(e){var i=e.newUserId,r=e.oldUserId,n=e.userKey;s.penetrateHybrid&&(!i&&r?n?s._clearNativeUserIdAndUserKey():s._clearNativeUserId():n?s._setNativeUserIdAndUserKey(d(i),d(n)):s._setNativeUserId(d(i)))})),null==n||n.on("SET_USERKEY",(function(e){var i=e.newUserKey,r=e.oldUserKey,n=e.userId;s.penetrateHybrid&&(!i&&r?s._clearNativeUserIdAndUserKey():s._setNativeUserIdAndUserKey(d(n),d(i)))})))},this._initHybridBridge=function(){var e,r,n,t=!1;return s.hasHybridBridge=!!window.GrowingWebViewJavascriptBridge,s.hasHybridBridge?((null===(e=null===window||void 0===window?void 0:window.GrowingWebViewJavascriptBridge)||void 0===e?void 0:e.configuration)||(window.GrowingWebViewJavascriptBridge.configuration=JSON.parse(window.GrowingWebViewJavascriptBridge.getConfiguration())),(null===(r=null===window||void 0===window?void 0:window.GrowingWebViewJavascriptBridge)||void 0===r?void 0:r.configuration)&&(s.hybridConfig=null===(n=null===window||void 0===window?void 0:window.GrowingWebViewJavascriptBridge)||void 0===n?void 0:n.configuration),t=!0):i.consoleText("gioHybridAdapter：当前不存在 GrowingWebViewJavascriptBridge，Web模式。","info"),t},this.sendBeforeListener=function(i){var r=i.requestData;if(s.hasHybridBridge){var n=s.processAttributes(e({},r));u(n,"trackingId"),o(f,n.eventType)&&(o(g,n.eventType)?s.penetrateHybrid&&s._dispatchEvent(n):(s.penetrateHybrid||u(n,["userId","userKey","cs1"]),s._dispatchEvent(n)))}},this.processAttributes=function(e){return a(e,(function(i,r){n(i)||t(i)?a(e[r],(function(i,o){n(i)||t(i)?e[r][o]=JSON.stringify(i):e[r][o]=d(i)})):e[r]=d(i)})),e},this._setNativeUserId=function(e){w((function(){return window.GrowingWebViewJavascriptBridge.setNativeUserId(e)}))},this._clearNativeUserId=function(){w((function(){return window.GrowingWebViewJavascriptBridge.clearNativeUserId()}))},this._setNativeUserIdAndUserKey=function(e,i){w((function(){return window.GrowingWebViewJavascriptBridge.setNativeUserIdAndUserKey(e,i)}))},this._clearNativeUserIdAndUserKey=function(){w((function(){return window.GrowingWebViewJavascriptBridge.clearNativeUserIdAndUserKey()}))},this._dispatchEvent=function(e){w((function(){var i;return null===(i=window.GrowingWebViewJavascriptBridge)||void 0===i?void 0:i.dispatchEvent(JSON.stringify(e))}))};var v=this.growingIO,y=v.emitter,p=v.utils;i=p,y.on("OPTION_INITIALIZED",this.onOptionsInit)}}}));
