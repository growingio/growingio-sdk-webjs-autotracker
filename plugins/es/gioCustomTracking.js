var t=function(){return t=Object.assign||function(t){for(var e,n=1,r=arguments.length;r>n;n++)for(var i in e=arguments[n])({}).hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},t.apply(this,arguments)},e=function(t){return["undefined","null"].includes(s(t))},n=function(t){return"string"===s(t)},r=function(t){return"object"===s(t)&&!e(t)},i=function(t){return Array.isArray(t)&&"array"===s(t)},o=function(t){return e(t)?"":"".concat(t)},u=function(t){return r(t)?Object.keys(t):[]},c=function(t,e){if(!r(t))return!1;try{if("string"===s(e))return delete t[e];if("array"===s(e))return e.map((function(e){return delete t[e]}));"object"===s(e)&&e.constructor===RegExp&&u(t).forEach((function(n){e.test(n)&&c(t,n)}))}catch(t){return!1}},a=function(t){return i(t)?0===t.length:r(t)?0===u(t).length:!t},s=function(t){return{}.toString.call(t).slice(8,-1).toLowerCase()},f=function(t){var n={};return r(t)&&function(t,c){u(t).forEach((function(u){return function(t,u){var c=o(u).slice(0,100);r(t)?n[c]=f(t):i(t)?(n[c]=t.slice(0,100),"cdp"===window.gioEnvironment&&(n[c]=n[c].join("||"))):n[c]=e(t)?"":o(t).slice(0,1e3)}(t[u],u)}))}(t),n},l={name:"gioCustomTracking",method:function(l){var g=this;this.growingIO=l,this.getValidResourceItem=function(t){if(t&&r(t)&&t.id&&t.key){var e={id:n(t.id)?t.id:o(t.id),key:n(t.key)?t.key:o(t.key)};return t.attributes&&(e.attributes=t.attributes),e}},this.getDynamicAttributes=function(t){return e(t)||u(t).forEach((function(e){var n;n=t[e],"function"===s(n)?t[e]=t[e]():r(t[e])?c(t,e):i(t[e])||(t[e]=o(t[e]))})),t},this.buildCustomEvent=function(e,i,o,u){var c,s;s=function(){var n=g.growingIO.dataStore,c=n.eventContextBuilder,s=n.eventConverter,l=n.currentPage,v=t({eventType:"CUSTOM",eventName:e,pageShowTimestamp:null==l?void 0:l.time,attributes:f(g.getDynamicAttributes(r(i)&&!a(i)?i:void 0)),resourceItem:f(g.getValidResourceItem(o))},c());a(u)||(v=t(t({},v),u)),s(v)},n(c=e)&&!a(c)&&c.match(/^[a-zA-Z_][0-9a-zA-Z_]{0,100}$/)?s():console.log("%c [GrowingIO]：事件名格式不正确，只能包含数字、字母和下划线，且不能以数字开头，字符总长度不能超过100!","color: #EF4444")},this.buildUserAttributesEvent=function(e,n){var r=g.growingIO.dataStore,i=r.eventContextBuilder,o=r.eventConverter,u=t({eventType:"LOGIN_USER_ATTRIBUTES",attributes:f(e)},i());a(n)||(u=t(t({},u),n)),o(u)}}};export{l as default};
