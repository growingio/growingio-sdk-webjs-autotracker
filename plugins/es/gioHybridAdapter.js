var e=function(e){return["undefined","null"].includes(a(e))},i=function(i){return"object"===a(i)&&!e(i)},r=function(e){return Array.isArray(e)&&"array"===a(e)},n=function(i){return e(i)?"":"".concat(i)},t=function(e){return i(e)?Object.keys(e):[]},o=function(e,i){t(e).forEach((function(r){return i(e[r],r)}))},d=function(e,r){if(!i(e))return!1;try{if("string"===a(r))return delete e[r];if("array"===a(r))return r.map((function(i){return delete e[i]}));"object"===a(r)&&r.constructor===RegExp&&t(e).forEach((function(i){r.test(i)&&d(e,i)}))}catch(e){return!1}},a=function(e){return{}.toString.call(e).slice(8,-1).toLowerCase()},s=function(e){try{return e()}catch(e){return}},c=["VIEW_CLICK","VIEW_CHANGE","FORM_SUBMIT","PAGE","CUSTOM","LOGIN_USER_ATTRIBUTES"],u=["LOGIN_USER_ATTRIBUTES"],w={name:"gioHybridAdapter",method:function(e){var t=this;this.growingIO=e,this.penetrateHybrid=!0,this.main=function(e){var i,r;t.projectId=e.projectId,r=e.penetrateHybrid,"boolean"===a(r)&&(t.penetrateHybrid=e.penetrateHybrid),t._initHybridBridge();var o=t.projectId===(null===(i=t.hybridConfig)||void 0===i?void 0:i.projectId);if(o){var d=t.growingIO.emitter;null==d||d.on("USERID_UPDATE",(function(e){var i=e.newUserId,r=e.oldUserId,o=e.userKey;t.penetrateHybrid&&(!i&&r?o?t._clearNativeUserIdAndUserKey():t._clearNativeUserId():o?t._setNativeUserIdAndUserKey(n(i),n(o)):t._setNativeUserId(n(i)))})),null==d||d.on("USERKEY_UPDATE",(function(e){var i=e.newUserKey,r=e.oldUserKey,o=e.userId;t.penetrateHybrid&&(!i&&r?t._clearNativeUserIdAndUserKey():t._setNativeUserIdAndUserKey(n(o),n(i)))}))}return o},this._initHybridBridge=function(){var e,i,r;t.hasHybridBridge=!!window.GrowingWebViewJavascriptBridge,t.hasHybridBridge&&((null===(e=null===window||void 0===window?void 0:window.GrowingWebViewJavascriptBridge)||void 0===e?void 0:e.configuration)||(window.GrowingWebViewJavascriptBridge.configuration=JSON.parse(window.GrowingWebViewJavascriptBridge.getConfiguration())),(null===(i=null===window||void 0===window?void 0:window.GrowingWebViewJavascriptBridge)||void 0===i?void 0:i.configuration)&&(t.hybridConfig=null===(r=null===window||void 0===window?void 0:window.GrowingWebViewJavascriptBridge)||void 0===r?void 0:r.configuration))},this.onSendBefore=function(e){var i,r,n=e.requestData;t.hasHybridBridge&&c.includes(n.eventType)&&(u.includes(n.eventType)?t.penetrateHybrid&&(null===(i=window.GrowingWebViewJavascriptBridge)||void 0===i||i.dispatchEvent(JSON.stringify(t.processAttributes(n)))):(t.penetrateHybrid||(d(n,"userId"),d(n,"userKey"),d(n,"cs1")),null===(r=window.GrowingWebViewJavascriptBridge)||void 0===r||r.dispatchEvent(JSON.stringify(t.processAttributes(n)))))},this.processAttributes=function(e){return o(e,(function(t,d){i(t)||r(t)?o(e[d],(function(t,o){i(t)||r(t)?e[d][o]=JSON.stringify(t):e[d][o]=n(t)})):e[d]=n(t)})),e},this._setNativeUserId=function(e){s((function(){return window.GrowingWebViewJavascriptBridge.setNativeUserId(e)}))},this._clearNativeUserId=function(){s((function(){return window.GrowingWebViewJavascriptBridge.clearNativeUserId()}))},this._setNativeUserIdAndUserKey=function(e,i){s((function(){return window.GrowingWebViewJavascriptBridge.setNativeUserIdAndUserKey(e,i)}))},this._clearNativeUserIdAndUserKey=function(){s((function(){return window.GrowingWebViewJavascriptBridge.clearNativeUserIdAndUserKey()}))}}};export{w as default};
