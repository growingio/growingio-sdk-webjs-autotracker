function e(e,o,i){if(i||2===arguments.length)for(var n,t=0,r=o.length;r>t;t++)!n&&t in o||(n||(n=[].slice.call(o,0,t)),n[t]=o[t]);return e.concat(n||[].slice.call(o))}var o=function(e){return["undefined","null"].includes(a(e))},i=function(e){return"object"===a(e)&&!o(e)},n={}.hasOwnProperty,t=function(e,i){return!o(e)&&n.call(e,i)},r=function(e){return i(e)?Object.keys(e):[]},a=function(e){return{}.toString.call(e).slice(8,-1).toLowerCase()},g={},c={}.hasOwnProperty;function s(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function l(e){try{return encodeURIComponent(e)}catch(e){return null}}g.stringify=function(e,o){o=o||"";var i,n,t=[];for(n in"string"!=typeof o&&(o="?"),e)if(c.call(e,n)){if((i=e[n])||null!=i&&!isNaN(i)||(i=""),n=l(n),i=l(i),null===n||null===i)continue;t.push(n+"="+i)}return t.length?o+t.join("&"):""},g.parse=function(e){for(var o,i=/([^=?#&]+)=?([^&]*)/g,n={};o=i.exec(e);){var t=s(o[1]),r=s(o[2]);null===t||null===r||t in n||(n[t]=r)}return n};var d={gioprojectid:"projectId",giodatacollect:"dataCollect",gioappid:"domain",giodatasourceid:"dataSourceId",gios:"sessionId",giou:"uid",giocs1:"userId",gioid:"gioId",giouserkey:"userKey",gioappchannel:"appChannel",giodevicebrand:"deviceBrand",giodevicemodel:"deviceModel",giodevicetype:"deviceType",giolanguage:"language",gionetworkstate:"networkState",giooperatingsystem:"operatingSystem",gioplatform:"platform",gioplatformversion:"platformVersion",gioscreenheight:"screenHeight",gioscreenwidth:"screenWidth"},u=["giodatasourceid","gioplatform","gioappchannel","giodevicebrand","giodevicemodel","giodevicetype","giolanguage","gionetworkstate","giooperatingsystem","gioplatformversion","gioscreenheight","gioscreenwidth"],f=["giocs1","gios","giou","gioid","giouserkey"],p="gio_search_cookie_gioenc",h={name:"gioEmbeddedAdapter",method:function(o){var n=this;this.growingIO=o,this.main=function(e){var o,c,s=e.projectId,l=e.appId,h=n.getGQS(),w=!1;return"none"!==n.qsFrom&&h.gioprojectid===s&&h.gioappid===l&&((function(e){return Array.isArray(e)&&"array"===a(e)}(c=h)?0!==c.length:i(c)?0!==r(c).length:c)?n.growingIO.storage.setItem(p,g.stringify(h)):n.growingIO.storage.removeItem(p),t(h,"giodatacollect")&&(n.growingIO.vdsConfig.dataCollect=["true",!0].includes(h.giodatacollect)),null===(o=n.growingIO.emitter)||void 0===o||o.on("SDK_INITIALIZED",(function(){var e=n.growingIO,o=e.userStore,i=e.vdsConfig.sessionExpires,r=e.dataStore.eventContextBuilderInst;f.forEach((function(e){var i;o[d[e]]=null!==(i=h[e])&&void 0!==i?i:""})),window.setInterval((function(){o.sessionId=h.gios}),.8*i*60*1e3),u.forEach((function(e){t(h,e)&&(r.minpExtraParams[d[e]]=h[e])}))})),n.growingIO.setUserId=function(){},n.growingIO.clearUserId=function(){},n.growingIO.setDataCollect=function(){},n.growingIO.setOption=function(){},w=!0),n.gioURLRewrite(),w},this.getGQS=function(){var o=n.growingIO.vdsConfig.hashtag,i=n.growingIO.storage.getItem(p),a=window.location.search,c=window.location.hash,s=o?c.substring(c.indexOf("?")+1):"",l=g.parse(a),d=g.parse(s),h=g.parse((i||"").replace("gioenc-","")),w={};if(t(l,"gioprojectid"))w=l,n.qsFrom="search";else if(t(d,"gioprojectid"))w=d,n.qsFrom="hash";else{if(!t(h,"gioprojectid"))return n.qsFrom="none",{};w=h,n.qsFrom="cookie"}var v={},m={},I=e(e(["gioappid","gioprojectid","giodatacollect"],f,!0),u,!0);return r(w).forEach((function(e){var o=e.toLowerCase();I.includes(o)?["","undefined","null",void 0,null].includes(w[e])||(v[o]=w[e],["true","TRUE",!0].includes(w[e])&&(v[o]=!0),["false","FALSE",!1].includes(w[e])&&(v[o]=!1)):m[e]=w[e]})),n.gqs=v,n.ngqs=m,v},this.gioURLRewrite=function(){var e=n.growingIO.vdsConfig.hashtag,o=window.location.search,i=window.location.hash,t=!1;if("search"===n.qsFrom&&(o=g.stringify(n.ngqs,!0),t=!0),e&&"hash"===n.qsFrom&&(i="".concat(i.split("?")[0]).concat(g.stringify(n.ngqs,!0)),t=!0),t){var r="".concat(window.location.pathname).concat(o||"").concat(i||"");window.history.replaceState(null,document.title,r)}},this.gqs={},this.ngqs={},this.qsFrom="search"}};export{h as default};
