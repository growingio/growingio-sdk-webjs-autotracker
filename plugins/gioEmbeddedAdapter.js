function e(e,o,i){if(i||2===arguments.length)for(var n,r=0,t=o.length;t>r;r++)!n&&r in o||(n||(n=[].slice.call(o,0,r)),n[r]=o[r]);return e.concat(n||[].slice.call(o))}var o,i=function(e){return null==e||void 0===e},n=function(e){return Array.isArray(e)&&"[object Array]"==={}.toString.call(e)},r={}.hasOwnProperty,t=function(e,o){return!i(e)&&r.call(e,o)},g=function(e){return"object"===a(e)?Object.keys(e):[]},a=function(e){var o=typeof e;return"object"===o?null===e?"null":n(e)?"array":o:o},s={},c={}.hasOwnProperty;function d(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function l(e){try{return encodeURIComponent(e)}catch(e){return null}}s.stringify=function(e,o){o=o||"";var i,n,r=[];for(n in"string"!=typeof o&&(o="?"),e)if(c.call(e,n)){if((i=e[n])||null!=i&&!isNaN(i)||(i=""),n=l(n),i=l(i),null===n||null===i)continue;r.push(n+"="+i)}return r.length?o+r.join("&"):""},s.parse=function(e){for(var o,i=/([^=?#&]+)=?([^&]*)/g,n={};o=i.exec(e);){var r=d(o[1]),t=d(o[2]);null===r||null===t||r in n||(n[r]=t)}return n};var u=e(["gioappid","giocs1","giodatacollect","gioprojectid","gios","giou"],["gioappchannel","giodevicebrand","giodevicemodel","giodevicetype","giolanguage","gionetworkstate","giooperatingsystem","gioplatform","gioplatformversion","gioscreenheight","gioscreenwidth"],!0),f=e(["giodatasourceid","gioid"],["giouserkey"],!0),p={gioappchannel:"appChannel",giodevicebrand:"deviceBrand",giodevicemodel:"deviceModel",giodevicetype:"deviceType",giolanguage:"language",gionetworkstate:"networkState",giooperatingsystem:"operatingSystem",gioplatform:"platform",gioplatformversion:"platformVersion",gioscreenheight:"screenHeight",gioscreenwidth:"screenWidth"},h="gio_search_cookie_gioenc",w=function(r){var a=this;this.growingIO=r,this.main=function(e){var r,c,d=e.projectId,l=e.appId,u=a.getGQS(),f=!1;return"none"!==a.qsFrom&&u.gioprojectid===d&&u.gioappid===l&&((n(c=u)?0!==c.length:function(e){return"[object Object]"==={}.toString.call(e)&&!i(e)}(c)?0!==g(c).length:c)?a.growingIO.storage.setItem(h,s.stringify(u)):a.growingIO.storage.removeItem(h),a.growingIO.setUserId=function(){},a.growingIO.clearUserId=function(){},"cdp"===o&&(a.growingIO.vdsConfig.dataSourceId=u.giodatasourceid,a.growingIO.vdsConfig.ignoreFields=a.growingIO.vdsConfig.ignoreFields.filter((function(e){return t(u,e)})),t(u,"giodatacollect")&&(a.growingIO.vdsConfig.dataCollect=["true",!0].includes(u.giodatacollect),a.growingIO.setDataCollect=function(){},a.growingIO.setOption=function(){})),null===(r=a.growingIO.emitter)||void 0===r||r.on("SDK_INITIALIZED",(function(){a.growingIO.userStore.sessionId=u.gios,a.growingIO.userStore.uid=u.giou,u.gioid&&(a.growingIO.userStore.gioId=u.gioid),u.giocs1&&(a.growingIO.userStore.userId=u.giocs1),"cdp"===o&&t(u,"giouserkey")&&(a.growingIO.userStore.userKey=u.giouserkey),window.setInterval((function(){a.growingIO.userStore.sessionId=u.gios}),.8*a.growingIO.vdsConfig.sessionExpires*60*1e3)})),g(p).forEach((function(e){t(u,e)&&(a.growingIO.dataStore.eventContextBuilderInst.minpExtraParams[p[e]]=u[e])})),f=!0),a.gioURLRewrite(),f},this.getGQS=function(){var i=a.growingIO.vdsConfig.hashtag,n=a.growingIO.storage.getItem(h),r=window.location.search,c=window.location.hash,d=i?c.substring(c.indexOf("?")+1):"",l=s.parse(r),p=s.parse(d),w=s.parse((n||"").replace("gioenc-","")),I="";if(t(l,"gioprojectid"))I=l,a.qsFrom="search";else if(t(p,"gioprojectid"))I=p,a.qsFrom="hash";else{if(!t(w,"gioprojectid"))return a.qsFrom="none",{};I=w,a.qsFrom="cookie"}var v={},m={},O="cdp"===o?e(e([],u,!0),f,!0):u;return g(I).forEach((function(e){var o=e.toLowerCase();O.includes(o)?["","undefined","null",void 0,null].includes(I[e])||(v[o]=I[e],"true"===I[e]&&(v[o]=!0),"false"===I[e]&&(v[o]=!1)):m[e]=I[e]})),a.gqs=v,a.ngqs=m,v},this.gioURLRewrite=function(){var e=a.growingIO.vdsConfig.hashtag,o=window.location.search,i=window.location.hash,n=!1;if("search"===a.qsFrom&&(o=s.stringify(a.ngqs,!0),n=!0),e&&"hash"===a.qsFrom&&(i="".concat(i.split("?")[0]).concat(s.stringify(a.ngqs,!0)),n=!0),n){var r="".concat(window.location.pathname).concat(o||"").concat(i||"");window.history.replaceState(null,document.title,r)}},o=this.growingIO.gioEnvironment,this.gqs={},this.ngqs={},this.qsFrom="search"};window.gioEmbeddedAdapter={name:"gioEmbeddedAdapter",method:w};var I={name:"gioEmbeddedAdapter",method:w};export{I as default};
