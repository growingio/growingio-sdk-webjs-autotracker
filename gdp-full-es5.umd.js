!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).gdp=t()}(this,(function(){"use strict";var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};function t(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+n+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}var n=function(){return n=Object.assign||function(e){for(var t,n=1,i=arguments.length;i>n;n++)for(var r in t=arguments[n])({}).hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},n.apply(this,arguments)};function i(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;o>r;r++)!i&&r in t||(i||(i=[].slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||[].slice.call(t))}var r=["web","wxwv","minp","alip","baidup","qq","bytedance"],o={autotrack:{type:"boolean",default:!0},compress:{type:"boolean",default:!0},dataCollect:{type:"boolean",default:!0},debug:{type:"boolean",default:!1},hashtag:{type:"boolean",default:!1},touch:{type:"boolean",default:!1},version:{type:"string",default:"1.0.0"},platform:{type:"string",default:"web"},cookieDomain:{type:"string",default:""}},a={enableIdMapping:{type:"boolean",default:!1},gtouchHost:{type:"string",default:""},host:{type:"string",default:"napi.growingio.com"},ignoreFields:{type:"array",default:[]},penetrateHybrid:{type:"boolean",default:!0},scheme:{type:"string",default:location.protocol.indexOf("http")>-1?location.protocol.replace(":",""):"https"},sessionExpires:{type:"number",default:30},performance:{type:"object",default:{monitor:!0,exception:!0}},embeddedIgnore:{type:"array",default:[]},storageType:{type:"string",default:"cookie"}},s={},u=["clearUserId","getGioInfo","getLocation","getOption","init","setDataCollect","setOption","setUserId","track","setGeneralProps","clearGeneralProps"];i(i([],u,!0),["setEvar","setPage","setUser","setVisitor"],!1);var c,d,l,g,f,h=i(i([],u,!0),["enableDebug","enableHT","setAutotrack","setTrackerHost","setTrackerScheme","setUserAttributes","getVisitorId","getDeviceId","registerPlugins","getPlugins","sendPage","sendVisit","trackTimerStart","trackTimerPause","trackTimerResume","trackTimerEnd","removeTimer","clearTrackTimer"],!1),p=["autotrack","dataCollect","dataSourceId","debug","host","hashtag","scheme"],v={autotrack:"无埋点采集",dataCollect:"数据采集",debug:"调试模式"},m=["send","setConfig","collectImp","setPlatformProfile"],I=["screenHeight","screenWidth"],w={click:"VIEW_CLICK",change:"VIEW_CHANGE",submit:"FORM_SUBMIT"},y="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},O="function"==typeof Array.from?Array.from:(d||(d=1,l=function(e){return"function"==typeof e},g=function(e){var t=function(e){var t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t}(e);return Math.min(Math.max(t,0),9007199254740991)},f=function(e){var t=e.next();return!t.done&&t},c=function(e){var t,n,i,r=this,o=arguments.length>1?arguments[1]:void 0;if(void 0!==o){if(!l(o))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(t=arguments[2])}var a=function(e,t){if(null!=e&&null!=t){var n=e[t];if(null==n)return;if(!l(n))throw new TypeError(n+" is not a function");return n}}(e,function(e){if(null!=e){if(["string","number","boolean","symbol"].indexOf(typeof e)>-1)return Symbol.iterator;if("undefined"!=typeof Symbol&&"iterator"in Symbol&&Symbol.iterator in e)return Symbol.iterator;if("@@iterator"in e)return"@@iterator"}}(e));if(void 0!==a){n=l(r)?Object(new r):[];var s,u,c=a.call(e);if(null==c)throw new TypeError("Array.from requires an array-like or iterable object");for(i=0;;){if(!(s=f(c)))return n.length=i,n;u=s.value,n[i]=o?o.call(t,u,i):u,i++}}else{var d=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var h,p=g(d.length);for(n=l(r)?Object(new r(p)):Array(p),i=0;p>i;)h=d[i],n[i]=o?o.call(t,h,i):h,i++;n.length=p}return n}),c),b=function(e){return q(["undefined","null"],Y(e))},_=function(e){return"string"===Y(e)},E=function(e){return"number"===Y(e)},S=function(e){return"NaN"===B(Number(e))},T=function(e){return"boolean"===Y(e)},N=function(e){return"object"===Y(e)&&!b(e)},C=function(e){return"regexp"===Y(e)},A=function(e){return"function"===Y(e)},x=function(e){return Array.isArray(e)&&"array"===Y(e)},P=function(e){return"date"===Y(e)},D=function(e){try{return H(e)[0]}catch(e){return}},R=function(e){try{var t=H(e);return t[t.length-1]}catch(e){return}},L=function(e,t){return void 0===t&&(t=1),x(e)&&E(t)?e.slice(t>0?t:1,e.length):e},k=function(e){if(x(e)){for(var t=0,n=[],i=0,r=e;i<r.length;i++){var o=r[i];o&&!Q(o)&&(n[t++]=o)}return n}return e},U=function(e,t){return e[G(e,t)]},G=function(e,t){var n=-1;return x(e)&&e.every((function(e,i){return!t(e)||(n=i,!1)})),n},q=function(e,t){return("array"===Y(e)||"string"===Y(e))&&e.indexOf(t)>=0},H=O,B=function(e){return b(e)?"":"".concat(e)},j=function(e,t){return"string"==typeof e?e.split(t):e},K=function(e){if(_(e)){var t=j(e,"");return"".concat(D(t).toLowerCase()).concat(L(t).join(""))}return e},W=function(e,t){return!!_(e)&&e.slice(0,t.length)===t},M=function(e,t){if(_(e)){var n=e.length,i=n;i>n&&(i=n);var r=i;return(i-=t.length)>=0&&e.slice(i,r)===t}return!1},V={}.hasOwnProperty,F=function(e,t){return!b(e)&&V.call(e,t)},X=function(e){return N(e)?Object.keys(e):[]},z=function(e,t){X(e).forEach((function(n){return t(e[n],n)}))},J=function(e,t){var n=X(e);return!(!N(e)||!N(t)||n.length!==X(t).length||q(n.map((function(n,i){return N(e[n])?J(e[n],t[n]):e[n]===t[n]})),!1))},Z=function(e,t){if(!N(e))return!1;try{return"string"===Y(t)?delete e[t]:"array"===Y(t)?t.map((function(t){return delete e[t]})):(C(t)&&X(e).forEach((function(n){t.test(n)&&Z(e,n)})),!0)}catch(e){return!1}},Q=function(e){return x(e)?0===e.length:N(e)?0===X(e).length:!e},Y=function(e){return{}.toString.call(e).slice(8,-1).toLowerCase()},$=Object.freeze({__proto__:null,isNil:b,isString:_,isNumber:E,isNaN:S,isBoolean:T,isObject:N,isRegExp:C,isFunction:A,isArray:x,isDate:P,fixed:function(e,t){return E(e)?Number(e.toFixed(E(t)?t:2)):_(e)&&"NaN"!==B(Number(e))?Number(Number(e).toFixed(E(t)?t:2)):e},head:D,last:R,drop:L,dropWhile:function(e,t){return x(e)?e.filter((function(e){return!t(e)})):e},compact:k,find:U,findIndex:G,includes:q,arrayFrom:H,toString:B,split:j,lowerFirst:K,upperFirst:function(e){if(_(e)){var t=j(e,"");return"".concat(D(t).toUpperCase()).concat(L(t).join(""))}return e},startsWith:W,endsWith:M,hasOwnProperty:V,has:F,keys:X,forEach:z,isEqual:J,get:function(e,t,n){var i=e;return N(e)?(t.split(".").forEach((function(e){i=i?i[e]:n})),i):n},unset:Z,isEmpty:Q,typeOf:Y,formatDate:function(e){if(P(e)){var t=function(e){return 10>e?"0"+e:e};return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+" "+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())+"."+t(e.getMilliseconds())}return e}}),ee=function(e,t){console.log("%c [GrowingIO]：".concat(e),{info:"color: #3B82F6;",error:"color: #EF4444;",warn:"color: #F59E0B;",success:"color: #10B981;"}[t]||"")},te=function(e){try{return e()}catch(e){return}},ne=function(e){var t={};return N(e)&&z(e,(function(e,n){var i,r=B(n).slice(0,100);N(e)?t[r]=ne(e):x(e)?(t[r]=e.slice(0,100),"cdp"===(null===(i=window.vds)||void 0===i?void 0:i.gioEnvironment)&&(t[r]=t[r].join("||"))):t[r]=b(e)?"":B(e).slice(0,1e3)})),t},ie=function(e,t,i,r){void 0===r&&(r={}),document.addEventListener?e.addEventListener(t,i,n(n({},{capture:!0}),r)):e.attachEvent?e.attachEvent("on"+t,i):e["on"+t]=i},re=function(e,t){return _(e)&&!Q(e)&&e.match(/^[a-zA-Z_][0-9a-zA-Z_]{0,100}$/)?t():(ee("事件名格式不正确，只能包含数字、字母和下划线，且不能以数字开头，字符总长度不能超过100!","error"),!1)},oe=Object.freeze({__proto__:null,consoleText:ee,niceTry:te,limitObject:ne,addListener:ie,flattenObject:function(e){void 0===e&&(e={});var t=n({},e);return X(t).forEach((function(e){N(t[e])?(X(t[e]).forEach((function(n){t["".concat(e,"_").concat(n)]=B(t[e][n])})),Z(t,e)):x(t[e])?(t[e].forEach((function(n,i){N(n)?X(n).forEach((function(r){t["".concat(e,"_").concat(i,"_").concat(r)]=B(n[r])})):t["".concat(e,"_").concat(i)]=B(n)})),Z(t,e)):b(t[e])||""===t[e]?Z(t,e):t[e]=B(t[e])})),t},eventNameValidate:re}),ae=function(e){return _(e)&&e.length>0||E(e)&&e>0},se=/^((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})(\.((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})){3}/i,ue=/^(https?:\/\/)|(([a-zA-Z0-9_-])+(\.)?)*(:\d+)?(\/((\.)?(\?)?=?&?[a-zA-Z0-9_-](\?)?)*)*$/i;function ce(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var i in n)e[i]=n[i]}return e}var de,le=function e(t,n){function i(e,i,r){if("undefined"!=typeof document){"number"==typeof(r=ce({},n,r)).expires&&(r.expires=new Date(Date.now()+864e5*r.expires)),r.expires&&(r.expires=r.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var a in r)r[a]&&(o+="; "+a,!0!==r[a]&&(o+="="+r[a].split(";")[0]));return document.cookie=e+"="+t.write(i,e)+o}}return Object.create({set:i,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var n=document.cookie?document.cookie.split("; "):[],i={},r=0;r<n.length;r++){var o=n[r].split("="),a=o.slice(1).join("=");try{var s=decodeURIComponent(o[0]);if(i[s]=t.read(a,s),e===s)break}catch(e){}}return e?i[e]:i}},remove:function(e,t){i(e,"",ce({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,ce({},this.attributes,t))},withConverter:function(t){return e(ce({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),ge=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},fe=function(){var e,t=!!(null===(e=null===window||void 0===window?void 0:window.navigator)||void 0===e?void 0:e.sendBeacon),n=window.navigator.userAgent;if(n.match(/(iPad|iPhone|iPod)/g)){var i=he(n);return t&&i>13}return t},he=function(e){var t=e.toLowerCase().match(/cpu.*os (.*?) like mac os/i);return!t||2>t.length?0:+t[1].split("_").slice(0,2).join(".")},pe=function(e){return M(e,"_gioenc")?e.slice(0,-7):e},ve=function(e){return S(Number(e))&&te((function(){return JSON.parse(e)}))||e},me={A:1,a:1,Z:1,z:1,"@":1,"{":1},Ie=function(e){return b(e)?e:te((function(){return"gioenc-".concat(ye(e))}))||e},we=function(e){return _(e)&&W(e,"gioenc-")&&te((function(){return ye(e.replace("gioenc-",""))}))||e},ye=function(e){return(e=e||"").split("").map((function(e){return me[e]?e:Oe(e)})).join("")},Oe=function(e){if(/[0-9]/.test(e))return 1^+e;var t=e.charCodeAt(0);return String.fromCharCode(1^t)},be=function(e){var t=this;this.domain=e,this.getItem=function(e){return ve(we(le.get(pe(e),{domain:t.domain,path:"/"})))},this.setItem=function(e,n,i){var r;r=_(n)?n.length?M(e,"_gioenc")?Ie(n):n:"":JSON.stringify(n),le.set(pe(e),r,{expires:i?new Date(i):3650,domain:t.domain,path:"/"})},this.removeItem=function(e){le.remove(pe(e),{domain:t.domain,path:"/"})},this.hasItem=function(e){return q(X(le.get()),pe(e))},this.getKeys=function(){return X(le.get())},this.type="Cookie"},_e=function(){this.getItem=function(e){var t=te((function(){return JSON.parse(localStorage.getItem(pe(e))||"")}))||{};return N(t)&&t.expiredAt>+Date.now()?ve(we(t.value)):void 0},this.setItem=function(e,t,n){var i=null!=n?n:+new Date(9999,12);localStorage.setItem(pe(e),JSON.stringify({value:_(t)&&t.length&&M(e,"_gioenc")?Ie(t):t,expiredAt:i}))},this.removeItem=function(e){return localStorage.removeItem(pe(e))},this.hasItem=function(e){return!!localStorage.getItem(pe(e))},this.getKeys=function(){return H(Array(localStorage.length)).map((function(e,t){return localStorage.key(t)}))},this.type="localStorage"},Ee={},Se=function(){this.getItem=function(e){var t=te((function(){return JSON.parse(Ee[pe(e)]||"")}));return N(t)&&t.expiredAt>+Date.now()?ve(we(t.value)):void 0},this.setItem=function(e,t,n){var i=null!=n?n:+new Date(9999,12);Ee[pe(e)]=JSON.stringify({value:_(t)&&t.length?Ie(t):t,expiredAt:i})},this.removeItem=function(e){return Z(Ee,pe(e))},this.hasItem=function(e){return F(Ee,pe(e))},this.getKeys=function(){return X(Ee)},this.type="memory"},Te=/^(\.ac\.|\.br\.|\.co\.|\.com\.|\.edu\.|\.gov\.|\.org\.|\.net\.)/,Ne=function(e){var t=[];try{var n=e.split("."),i=R(n);if(n.length>=2&&(isNaN(Number(i))||0>Number(i)||Number(i)>255)){var r=".".concat(n.slice(-2).join("."));Te.test(r)?de=r:t.push(r);var o=".".concat(n.slice(-3).join("."));Te.test(o)||t.includes(o)||t.push(o);var a=".".concat(n.slice(-4).join("."));Te.test(a)||t.includes(a)||t.push(a)}}catch(e){}return t},Ce=function(e){var t="";return e.every((function(e){return!Ae(e)||(t=e,!1)})),t},Ae=function(e){try{le.set("gioCookie","yes",{domain:e});var t=!!le.get("gioCookie",{domain:e});return le.remove("gioCookie",{domain:e}),t}catch(e){return!1}},xe=function(e){var t,n,r,o=e.storageType,a=e.cookieDomain,s=e.projectId;if(q(["cookie","localstorage"],o)||(o="cookie"),"cookie"===o&&(n=!!(r=navigator.userAgent.indexOf("Electron")>-1||q(["","localhost","127.0.0.1"],window.location.hostname)||!q(["http:","https:"],window.location.protocol)?"":Ce(i(i([],Ne(window.location.hostname),!0),[window.location.hostname],!1)))),"cookie"===o&&n){var u=new be(r);if(a){var c=Ne(a),d=Ce(Q(c)?[]:i([a],Ne(a),!0));d&&Ae(d)?u.domain=d:ee("指定Cookie域无效或无权限，使用默认域！","warn")}t=u}else t=function(){try{var e=window.localStorage,t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(e){return!1}}()?new _e:new Se;return"cookie"===o&&de&&Ae(de)&&function(e,t,n){if(t&&Ae(t)){var i=new be(t);["".concat(n,"_gdp_session_id"),"gdp_user_id_gioenc","".concat(n,"_gdp_cs1_gioenc"),"".concat(n,"_gdp_user_key_gioenc"),"".concat(n,"_gdp_gio_id_gioenc"),"".concat(n,"_gdp_sequence_ids"),"".concat(n,"_gdp_session_id_sent")].forEach((function(t){var n=i.getItem(t);i.hasItem(t)&&(e.setItem(t,n),i.removeItem(t))})),i=void 0}}(t,de,s),t},Pe="OPTION_INITIALIZED",De="SDK_INITIALIZED",Re="SESSIONID_UPDATE",Le="SET_USERID",ke="SET_USERKEY",Ue={name:"gioCompress",method:function(e){var t=this;this.growingIO=e,this._compress=function(e,t,n){if(null===e)return"";var i,r,o,a={},s={},u="",c="",d="",l=2,g=3,f=2,h=[],p=0,v=0;for(o=0;o<e.length;o+=1)if(u=e.charAt(o),{}.hasOwnProperty.call(a,u)||(a[u]=g++,s[u]=!0),c=d+u,{}.hasOwnProperty.call(a,c))d=c;else{if({}.hasOwnProperty.call(s,d)){if(256>d.charCodeAt(0)){for(i=0;f>i;i++)p<<=1,v===t-1?(v=0,h.push(n(p)),p=0):v++;for(r=d.charCodeAt(0),i=0;8>i;i++)p=p<<1|1&r,v===t-1?(v=0,h.push(n(p)),p=0):v++,r>>=1}else{for(r=1,i=0;f>i;i++)p=p<<1|r,v===t-1?(v=0,h.push(n(p)),p=0):v++,r=0;for(r=d.charCodeAt(0),i=0;16>i;i++)p=p<<1|1&r,v===t-1?(v=0,h.push(n(p)),p=0):v++,r>>=1}0==--l&&(l=Math.pow(2,f),f++),delete s[d]}else for(r=a[d],i=0;f>i;i++)p=p<<1|1&r,v===t-1?(v=0,h.push(n(p)),p=0):v++,r>>=1;0==--l&&(l=Math.pow(2,f),f++),a[c]=g++,d=u+""}if(""!==d){if({}.hasOwnProperty.call(s,d)){if(256>d.charCodeAt(0)){for(i=0;f>i;i++)p<<=1,v===t-1?(v=0,h.push(n(p)),p=0):v++;for(r=d.charCodeAt(0),i=0;8>i;i++)p=p<<1|1&r,v===t-1?(v=0,h.push(n(p)),p=0):v++,r>>=1}else{for(r=1,i=0;f>i;i++)p=p<<1|r,v===t-1?(v=0,h.push(n(p)),p=0):v++,r=0;for(r=d.charCodeAt(0),i=0;16>i;i++)p=p<<1|1&r,v===t-1?(v=0,h.push(n(p)),p=0):v++,r>>=1}0==--l&&(l=Math.pow(2,f),f++),delete s[d]}else for(r=a[d],i=0;f>i;i++)p=p<<1|1&r,v===t-1?(v=0,h.push(n(p)),p=0):v++,r>>=1;0==--l&&(l=Math.pow(2,f),f++)}for(r=2,i=0;f>i;i++)p=p<<1|1&r,v===t-1?(v=0,h.push(n(p)),p=0):v++,r>>=1;for(;;){if(p<<=1,v===t-1){h.push(n(p));break}v++}return h.join("")},this.compress=function(e){var n=t;return t._compress(e,16,(function(e){return n.f(e)}))},this.compressToUTF16=function(e){var n=t;return null===e?"":t._compress(e,15,(function(e){return n.f(e+32)}))+" "},this.compressToUint8Array=function(e){for(var n=t.compress(e),i=new Uint8Array(2*n.length),r=0,o=n.length;o>r;r++){var a=n.charCodeAt(r);i[2*r]=a>>>8,i[2*r+1]=a%256}return i},this.compressToEncodedURIComponent=function(e){return null==e?"":t._compress(e,6,(function(e){return this.keyStrUriSafe.charAt(e)}))},this.f=String.fromCharCode,this.keyStrUriSafe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"}},Ge={name:"gioCustomTracking",method:function(e){var t=this;this.growingIO=e,this.getValidResourceItem=function(e){if(e&&N(e)&&e.id&&e.key){var t={id:_(e.id)?e.id:B(e.id),key:_(e.key)?e.key:B(e.key)};return e.attributes&&(t.attributes=e.attributes),t}},this.getDynamicAttributes=function(e){return b(e)||X(e).forEach((function(t){A(e[t])?e[t]=e[t]():N(e[t])?Z(e,t):x(e[t])||(e[t]=B(e[t]))})),e},this.buildCustomEvent=function(e,i,r,o){re(e,(function(){var a=t.growingIO.dataStore,s=a.eventContextBuilder,u=a.eventConverter,c=a.currentPage,d=n({eventType:"CUSTOM",eventName:e,pageShowTimestamp:null==c?void 0:c.time,attributes:ne(t.getDynamicAttributes(N(i)&&!Q(i)?i:void 0)),resourceItem:ne(t.getValidResourceItem(r))},s());Q(o)||(d=n(n({},d),o)),u(d)}))},this.buildUserAttributesEvent=function(e,i){var r=t.growingIO.dataStore,o=r.eventContextBuilder,a=r.eventConverter,s=n({eventType:"LOGIN_USER_ATTRIBUTES",attributes:ne(e)},o());Q(i)||(s=n(n({},s),i)),a(s)}}},qe={},He={}.hasOwnProperty;function Be(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function je(e){try{return encodeURIComponent(e)}catch(e){return null}}qe.stringify=function(e,t){t=t||"";var n,i,r=[];for(i in"string"!=typeof t&&(t="?"),e)if(He.call(e,i)){if((n=e[i])||null!=n&&!isNaN(n)||(n=""),i=je(i),n=je(n),null===i||null===n)continue;r.push(i+"="+n)}return r.length?t+r.join("&"):""},qe.parse=function(e){for(var t,n=/([^=?#&]+)=?([^&]*)/g,i={};t=n.exec(e);){var r=Be(t[1]),o=Be(t[2]);null===r||null===o||r in i||(i[r]=o)}return i};var Ke={gioprojectid:"projectId",giodatacollect:"dataCollect",gioappid:"domain",giodatasourceid:"dataSourceId",gios:"sessionId",giou:"uid",giocs1:"userId",gioid:"gioId",giouserkey:"userKey",gioappchannel:"appChannel",giodevicebrand:"deviceBrand",giodevicemodel:"deviceModel",giodevicetype:"deviceType",giolanguage:"language",gionetworkstate:"networkState",giooperatingsystem:"operatingSystem",gioplatform:"platform",gioplatformversion:"platformVersion",gioscreenheight:"screenHeight",gioscreenwidth:"screenWidth"},We=["giodatasourceid","gioplatform","gioappchannel","giodevicebrand","giodevicemodel","giodevicetype","giolanguage","gionetworkstate","giooperatingsystem","gioplatformversion","gioscreenheight","gioscreenwidth"],Me=["giocs1","gios","giou","gioid","giouserkey"],Ve="gio_search_cookie_gioenc",Fe={name:"gioEmbeddedAdapter",method:function(e){var t=this;this.growingIO=e,this.main=function(){var e,n=t.growingIO.vdsConfig,i=n.projectId,r=n.appId,o=t.getGQS(),a=!1;return"none"!==t.qsFrom&&o.gioprojectid===i&&o.gioappid===r&&(Q(o)?t.growingIO.storage.removeItem(Ve):t.growingIO.storage.setItem(Ve,qe.stringify(o)),F(o,"giodatacollect")&&(t.growingIO.vdsConfig.dataCollect=q(["true",!0],o.giodatacollect)),null===(e=t.growingIO.emitter)||void 0===e||e.on("SDK_INITIALIZED",(function(){var e=t.growingIO,n=e.userStore,i=e.vdsConfig.sessionExpires,r=e.dataStore.eventContextBuilderInst;Me.forEach((function(e){var t;n[Ke[e]]=null!==(t=o[e])&&void 0!==t?t:""})),window.setInterval((function(){n.sessionId=o.gios}),.8*i*60*1e3),We.forEach((function(e){F(o,e)&&(r.minpExtraParams[Ke[e]]=o[e])}))})),t.growingIO.setUserId=function(){},t.growingIO.clearUserId=function(){},F(o,"giodatacollect")&&(t.growingIO.setDataCollect=function(){},t.growingIO.setOption=function(){}),a=!0),t.gioURLRewrite(),a},this.getGQS=function(){var e=t.growingIO.vdsConfig.hashtag,n=t.growingIO.storage.getItem(Ve),r=window.location.search,o=window.location.hash,a=e?o.substring(o.indexOf("?")+1):"",s=qe.parse(r),u=qe.parse(a),c=qe.parse((n||"").replace("gioenc-","")),d={};if(F(s,"gioprojectid"))d=s,t.qsFrom="search";else if(F(u,"gioprojectid"))d=u,t.qsFrom="hash";else{if(!F(c,"gioprojectid"))return t.qsFrom="none",{};d=c,t.qsFrom="cookie"}var l={},g={},f=i(i(["gioappid","gioprojectid","giodatacollect"],Me,!0),We,!0);return X(d).forEach((function(e){var t=e.toLowerCase();q(f,t)?q(["","undefined","null",void 0,null],d[e])||(l[t]=d[e],q(["true","TRUE",!0],d[e])&&(l[t]=!0),q(["false","FALSE",!1],d[e])&&(l[t]=!1)):g[e]=d[e]})),t.gqs=l,t.ngqs=g,l},this.gioURLRewrite=function(){var e=t.growingIO.vdsConfig.hashtag,n=window.location.search,i=window.location.hash,r=!1;if("search"===t.qsFrom&&(n=qe.stringify(t.ngqs,!0),r=!0),e&&"hash"===t.qsFrom&&(i="".concat(i.split("?")[0]).concat(qe.stringify(t.ngqs,!0)),r=!0),r){var o="".concat(window.location.pathname).concat(n||"").concat(i||"");window.history.replaceState(null,document.title,o)}},this.gqs={},this.ngqs={},this.qsFrom="search",this.growingIO.emitter.on(Pe,(function(){t.growingIO.useEmbeddedInherit=t.main()}))}},Xe={},ze={};!function(e){var t=y&&y.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;o>r;r++)!i&&r in t||(i||(i=[].slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||[].slice.call(t))};Object.defineProperty(e,"__esModule",{value:!0}),e.GROWING_TITLE_OLD=e.GROWING_TITLE=e.GROWING_GTITLE=e.GROWING_CDP_INDEX=e.GROWING_INDEX_OLD=e.GROWING_INDEX=e.GROWING_CONTAINER=e.GROWING_TRACK=e.GROWING_IGNORE=e.VALID_CLASS_SELECTOR=e.VALID_ID_SELECTOR=e.EXCLUDE_CLASS_RE=e.UNSUPPORTED_TAGS=e.TEXT_NODE=e.UNSUPPORTED_CLICK_TAGS=e.SUPPORTED_ICON_TAGS=e.SUPPORTED_CHANGE_TYPES=e.SUPPORTED_CLICK_INPUT_TYPES=e.SUPPORTED_CONTAINER_TAGS=e.LIST_TAGS=void 0,e.LIST_TAGS=["TR","LI","DL"],e.SUPPORTED_CONTAINER_TAGS=t(["A","BUTTON"],e.LIST_TAGS,!0),e.SUPPORTED_CLICK_INPUT_TYPES=["button","submit","reset"],e.SUPPORTED_CHANGE_TYPES=["radio","checkbox","search"],e.SUPPORTED_ICON_TAGS=["I","EM","svg","IMG"],e.UNSUPPORTED_CLICK_TAGS=["TEXTAREA","HTML","BODY"],e.TEXT_NODE=["I","SPAN","EM","B","STRONG"],e.UNSUPPORTED_TAGS=["tspan","text","g","rect","path","defs","clippath","desc","title","math","use"],e.EXCLUDE_CLASS_RE=/(^| |[^ ]+\-)(clear|clearfix|active|hover|enabled|current|selected|unselected|hidden|display|focus|disabled|undisabled|open|checked|unchecked|undefined|null|ng-|growing-)[^\. ]*/g,e.VALID_ID_SELECTOR=/^[a-zA-Z-\_][a-zA-Z\-\_0-9]+$/,e.VALID_CLASS_SELECTOR=/^([a-zA-Z\-\_0-9]+)$/,e.GROWING_IGNORE="data-growing-ignore",e.GROWING_TRACK="data-growing-track",e.GROWING_CONTAINER="data-growing-container",e.GROWING_INDEX="data-growing-index",e.GROWING_INDEX_OLD="data-growing-idx",e.GROWING_CDP_INDEX="data-index",e.GROWING_GTITLE="data-growing-title",e.GROWING_TITLE="data-title",e.GROWING_TITLE_OLD="growing-title"}(ze);var Je={},Ze={};Object.defineProperty(Ze,"__esModule",{value:!0}),Ze.lastFindIndex=Ze.findIndex=Ze.arrayEquals=Ze.rmBlank=Ze.normalizePath=Ze.splitNoEmpty=Ze.filterText=void 0,Ze.filterText=function(e,t){if(void 0===t&&(t=!0),e&&(null==(e=e.replace(/[\n \t]+/g," ").trim())?void 0:e.length))return e.slice(0,t?50:void 0)},Ze.splitNoEmpty=function(e,t){return e?e.split(t).filter((function(e){return!!e})):[]},Ze.normalizePath=function(e){var t=e.length;return t>1&&"/"===e.charAt(t-1)?e.slice(0,t-1):e},Ze.rmBlank=function(e){return e?e.replace(/[\n \t]+/g,""):""},Ze.arrayEquals=function(e,t){if(!e||!t)return!1;if(e.length!==t.length)return!1;for(var n=0,i=e.length;i>n;n++)if(e[n]!==t[n])return!1;return!0},Ze.findIndex=function(e,t){if(null==e||"function"!=typeof t)return-1;for(var n=0;n<e.length;n++){var i=e[n];if(t.call(void 0,i))return n}return-1},Ze.lastFindIndex=function(e,t){if(null==e||"function"!=typeof t)return-1;for(var n=e.length-1;n>=0;n--){var i=e[n];if(t.call(void 0,i))return n}return-1},function(e){var t=y&&y.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;o>r;r++)!i&&r in t||(i||(i=[].slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||[].slice.call(t))},n=y&&y.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.removeDiffTagOnHeadAndTail=e.computeXpath=e.getMarkIndex=e.getEffectiveNode=e.isIgnore=e.depthInside=e.changeableInput=e.clickableInput=e.onlyContainsTextChildren=e.onlyContainsIconChildren=e.supportIconTag=e.isContainerTag=e.isListTag=e.isParentOfLeaf=e.isLeaf=e.getChildren=e.getDeepChildren=e.findParent=e.isRootNode=e.hasValidAttribute=void 0;var i=Ze,r=ze,o=n(O);e.hasValidAttribute=function(e,t){return e instanceof Element&&e.hasAttribute(t)&&"false"!==e.getAttribute(t)},e.isRootNode=function(e){return!e||-1!==["BODY","HTML","#document"].indexOf(e.nodeName)},e.findParent=function(t,n){for(var i=t.parentNode;i&&!(0,e.isRootNode)(i);){if(n(i))return i;i=i.parentNode}},e.getDeepChildren=function(n){return(0,o.default)((null==n?void 0:n.childNodes)||[]).reduce((function(n,i){return i instanceof Element?t(t(t([],n,!0),[i],!1),(0,e.getDeepChildren)(i),!0):n}),[])},e.getChildren=function(e){return(0,o.default)((null==e?void 0:e.childNodes)||[]).filter((function(e){return e instanceof Element}))},e.isLeaf=function(t){return!t.hasChildNodes()||"svg"===t.nodeName||0===(0,e.getChildren)(t).length},e.isParentOfLeaf=function(t){return!(!t.hasChildNodes()||"svg"===t.nodeName)&&0===(0,o.default)(t.childNodes).filter((function(t){return!(0,e.isLeaf)(t)})).length},e.isListTag=function(e){return-1!==r.LIST_TAGS.indexOf(e.nodeName)},e.isContainerTag=function(t){return(0,e.hasValidAttribute)(t,r.GROWING_CONTAINER)||-1!==r.SUPPORTED_CONTAINER_TAGS.indexOf(t.nodeName)},e.supportIconTag=function(e){var t=e.nodeName;return-1!==r.SUPPORTED_ICON_TAGS.indexOf(t)},e.onlyContainsIconChildren=function(t){if(t.textContent)return!1;var n=(0,e.getChildren)(t);if(0===n.length)return!1;for(var i=0,r=n;i<r.length;i++){var o=r[i];if(!(0,e.supportIconTag)(o)&&"SPAN"!==o.nodeName)return!1}return!0},e.onlyContainsTextChildren=function(t){return 0!==(0,e.getChildren)(t).length&&!(0,e.getDeepChildren)(t).map((function(e){return e.tagName})).some((function(e){return-1===r.TEXT_NODE.indexOf(e)}))},e.clickableInput=function(e){return e instanceof HTMLInputElement&&"INPUT"===e.tagName&&-1!==r.SUPPORTED_CLICK_INPUT_TYPES.indexOf(e.type)},e.changeableInput=function(e){return e instanceof HTMLInputElement&&"INPUT"===e.tagName&&-1!==r.SUPPORTED_CHANGE_TYPES.indexOf(e.type)},e.depthInside=function(t,n,i){if(void 0===n&&(n=4),void 0===i&&(i=1),i>n)return!1;for(var r="svg"===t.tagName?[]:(0,e.getChildren)(t),o=0;o<r.length;o++){var a=r[o];if(!(0,e.depthInside)(a,n,i+1))return!1}return n>=i},e.isIgnore=function(t){if(!(t instanceof Element)||(0,e.hasValidAttribute)(t,r.GROWING_IGNORE))return!0;for(var n=t.parentNode;n&&!(0,e.isRootNode)(n);){if((0,e.hasValidAttribute)(n,r.GROWING_IGNORE))return!0;n=n.parentNode}return!1},e.getEffectiveNode=function(t){for(var n,i;t&&(i=void 0,!((n=t)instanceof Element&&-1===r.UNSUPPORTED_TAGS.indexOf(null===(i=n.tagName)||void 0===i?void 0:i.toLowerCase())))&&t.parentNode;)t=t.parentNode;var o,a=t.parentNode;return!(0,e.isRootNode)(a)&&((0,e.onlyContainsIconChildren)(a)||"BUTTON"===(o=a).tagName&&(0,e.onlyContainsTextChildren)(o))?a:t},e.getMarkIndex=function(e){if(e instanceof Element){var t=e.getAttribute(r.GROWING_INDEX)||e.getAttribute(r.GROWING_INDEX_OLD)||e.getAttribute(r.GROWING_CDP_INDEX);if(t){if(/^\d{1,10}$/.test(t)&&+t>=0&&2147483647>+t)return+t;window.console.error("[GioNode]：标记的index不符合规范（index必须是大于等于0且小于2147483647的整数字）。",t)}}},e.computeXpath=function(e){for(var t=e.parentPaths(!0),n=Math.min(t.length,+(t.length>=10)+4),i=["","",""],r=0;r<t.length;r++){var o=t[r].path,a=t[r].name;i[0]=o+i[0],i[2]="/".concat(a)+i[2],n>r&&(i[1]=o+i[1])}return i},e.removeDiffTagOnHeadAndTail=function(e,t){var n=function(e){return e.nodeName===t.nodeName},r=(0,i.findIndex)(e,n),o=(0,i.lastFindIndex)(e,n);return-1===r||-1===o?[]:e.slice(r,o+1)}}(Je);var Qe={},Ye={};Object.defineProperty(Ye,"__esModule",{value:!0});var $e=ze,et=Ze,tt=Je;function nt(e){var t;if(e instanceof Element){var n=e.getAttribute("name");if(n)return[n];if(e.hasAttribute("class")){var i=null===(t=e.getAttribute("class"))||void 0===t?void 0:t.replace($e.EXCLUDE_CLASS_RE,"").trim();if(null==i?void 0:i.length)return i.split(/\s+/).filter((function(e){return $e.VALID_CLASS_SELECTOR.test(e)&&!e.match(/[a-z][A-Z][a-z][A-Z]/)&&!e.match(/[0-9][0-9][0-9][0-9]/)})).sort()}}return[]}var it=function(){function e(e){var t;this.node=e,this.tagName=this.node.nodeName,this.name=this.tagName.toLowerCase(),this.id=(t=this.node).id&&$e.VALID_ID_SELECTOR.test(t.id)?t.id:null,this.classList=nt(this.node),this.guessListAndIndex()}return e.prototype.guessListAndIndex=function(){var e,t=this;this._tagList=(0,tt.isListTag)(this.node);var n=(0,tt.removeDiffTagOnHeadAndTail)((0,tt.getChildren)(this.node.parentNode),this.node);if(this._tagList&&-1!==(o=n.filter((function(e){return e.tagName===t.tagName})).indexOf(this.node))&&(this._index=o+1),n.length>=3&&(null===(e=this.classList)||void 0===e?void 0:e.length)){for(var i=0,r=0,o=1;o<=n.length;o++){var a=n[o-1];if(a.tagName!==this.tagName){r=0;break}(0,et.arrayEquals)(this.classList,nt(a))&&(r+=1),this.node===a&&(i=o)}3>r||(this._pseudoList=!0,this._index=this._index||i)}},Object.defineProperty(e.prototype,"path",{get:function(){var e;return this._path||(this._path="/".concat(this.name),this.id&&(this._path+="#".concat(this.id)),(null===(e=this.classList)||void 0===e?void 0:e.length)&&(this._path+=".".concat(this.classList.join(".")))),this._path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pseudoList",{get:function(){return!!this._pseudoList},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"list",{get:function(){return!!this._tagList||!!this._pseudoList},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){var e;return null!==(e=(0,tt.getMarkIndex)(this.node))&&void 0!==e?e:this._index},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"container",{get:function(){return(0,tt.isContainerTag)(this.node)||this.list},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.node.parentNode?new e(this.node.parentNode):null},enumerable:!1,configurable:!0}),e.prototype.parentPaths=function(e){void 0===e&&(e=!1);for(var t=e?[this]:[],n=this.parent;n&&!(0,tt.isRootNode)(n.node);)t.push(n),n=n.parent;return t},e}();Ye.default=it;var rt={};Object.defineProperty(rt,"__esModule",{value:!0}),rt.getElementHref=rt.getImgHref=rt.getAnchorHref=void 0;var ot=Ze;function at(e){if(e.hasAttribute("href")){var t=e.getAttribute("href");if(t&&0!==t.indexOf("javascript"))return(0,ot.normalizePath)(t.slice(0,320))}}function st(e){if(e.src&&-1===e.src.indexOf("data:image"))return e.src}rt.getAnchorHref=at,rt.getImgHref=st,rt.getElementHref=function(e){var t=e;if(t)switch(e.nodeName.toLowerCase()){case"a":return at(t);case"img":return st(t)}};var ut={},ct=y&&y.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ut,"__esModule",{value:!0}),ut.getElementContent=ut.getFormContent=void 0;var dt=Je,lt=rt,gt=ze,ft=ct(Ye),ht=Ze,pt=ct(O),vt=function(e){return e.htmlFor||e.getAttribute("for")},mt=function(e){var t=e.getAttribute(gt.GROWING_GTITLE)||e.getAttribute(gt.GROWING_TITLE)||e.getAttribute(gt.GROWING_TITLE_OLD)||e.getAttribute("title");return null==t?void 0:t.trim()};function It(e){var t=e.node;return e.list?wt(t):(0,ht.filterText)(t.textContent)||void 0}function wt(e){for(var t=void 0,n=!1,i=0,r=(0,pt.default)(e.childNodes);i<r.length;i++){var o=r[i];if(o.nodeType===Node.TEXT_NODE){var a=(0,ht.filterText)(o.textContent);if(a)return a}if(o.nodeType===Node.ELEMENT_NODE&&-1===["INPUT","SELECT"].indexOf(o.nodeName)){if(new ft.default(o).pseudoList)return;n=(0,dt.onlyContainsIconChildren)(o)||(0,dt.supportIconTag)(o);var s=Ot(o);if(n)t=s,n=!1;else if(s||(s=wt(o)),s)return s}}return t}function yt(e){for(var t=e.getElementsByTagName("input"),n=0,i=(0,pt.default)(t);n<i.length;n++){var r=i[n];if(("search"===r.type||"text"===r.type&&("q"===r.id||-1!==r.id.indexOf("search")||"q"===r.name||-1!==r.name.indexOf("search")))&&!(0,dt.isIgnore)(r)){var o=Ot(r);if(o)return o}}}function Ot(e){return function(e){var t=e;if(t){var n=mt(t);if(n)return n;var i,r,o,a=new ft.default(e);switch(e.nodeName.toLowerCase()){case"a":return function(e){if(((0,dt.isLeaf)(e)||(0,dt.onlyContainsIconChildren)(e))&&e.textContent){var t=(0,ht.filterText)(e.textContent);if(t)return t}var n=(0,lt.getAnchorHref)(e);if(n){var i=n.indexOf("?");return i>-1?n.slice(0,i):n}}(t);case"svg":return function(e){for(var t=0,n=(0,pt.default)(e.childNodes);t<n.length;t++){var i=n[t];if(i.nodeType===Node.ELEMENT_NODE&&"use"===i.tagName.toLowerCase()&&i.hasAttribute("xlink:href"))return i.getAttribute("xlink:href")}}(t);case"button":return(null===(o=(r=t).name)||void 0===o?void 0:o.length)?r.name:(0,ht.filterText)(r.textContent)||wt(r);case"img":return function(e){if(e.alt)return e.alt;var t=(0,lt.getImgHref)(e);if(t){var n=t.split("?")[0].split("/");if(n.length>0)return n[n.length-1]}}(t);case"label":return It(a);case"input":return function(e){if((0,dt.clickableInput)(e))return e.value;if("password"!==e.type&&(0,dt.hasValidAttribute)(e,gt.GROWING_TRACK))return e.value;if((0,dt.changeableInput)(e)){var t=(0,dt.findParent)(e,(function(e){return"LABEL"===e.nodeName}));if(!t&&e.id)for(var n=document.body.getElementsByTagName("label"),i=0;i<n.length;i++){var r=n[i];if(vt(r)===e.id){t=r;break}}if(t){var o=It(new ft.default(t));if(o&&o.length>0)return o+" ("+e.checked+")"}return e.value}}(t);case"select":return i=t,(0,pt.default)(i.options).filter((function(e){return e.selected})).map((function(e){return e.label})).join(", ")||i.value;case"form":return yt(t)}return(0,dt.isLeaf)(t)?function(e){var t=(0,ht.filterText)(e.textContent);if(t)return t}(t):(0,dt.isParentOfLeaf)(t)&&!(0,dt.onlyContainsIconChildren)(t)?function(e){for(var t="",n=0,i=(0,pt.default)(e.childNodes);n<i.length;n++){var r=i[n];t+=(r.nodeType===Node.TEXT_NODE&&r.textContent?r.textContent.trim():"")+" "}return(0,ht.filterText)(t,!1)}(t):a.container||(0,dt.onlyContainsIconChildren)(e)?wt(t):void 0}}(e)||void 0}ut.getFormContent=yt,ut.getElementContent=Ot;var bt=y&&y.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+n+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),_t=y&&y.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Qe,"__esModule",{value:!0});var Et=_t(Ye),St=rt,Tt=ut,Nt=Je,Ct=function(e){function t(t){var n=e.call(this,t)||this;n.node=t;var i=(0,Nt.computeXpath)(n),r=i[0],o=i[1],a=i[2];return n.fullXpath=r,n.xpath=o,n.skeleton=a,n}return bt(t,e),Object.defineProperty(t.prototype,"href",{get:function(){return(0,St.getElementHref)(this.node)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"content",{get:function(){return(0,Tt.getElementContent)(this.node)},enumerable:!1,configurable:!0}),t}(Et.default);Qe.default=Ct;var At=y&&y.__assign||function(){return At=Object.assign||function(e){for(var t,n=1,i=arguments.length;i>n;n++)for(var r in t=arguments[n])({}).hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},At.apply(this,arguments)},xt=y&&y.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Xe,"__esModule",{value:!0});var Pt,Dt,Rt=ze,Lt=Je,kt=xt(Qe),Ut=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!0),this.origin=e,this.action=t,this.direct=n,this.target="self"===t?e:(0,Lt.getEffectiveNode)(e),this.ignore=(0,Lt.isIgnore)(this.target),this.vnode=new kt.default(this.target),this.tagName=this.vnode.tagName}return Object.defineProperty(e.prototype,"content",{get:function(){return this.vnode.content},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"href",{get:function(){return this.vnode.href},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this.vnode.index},enumerable:!1,configurable:!0}),e.prototype.inferParentIndex=function(){var t=this;return this.parentIndex||(0,Lt.findParent)(this.target,(function(n){var i=new e(n,t.action,!1);i.traceable()&&i.index&&(t.parentIndex=i.index)})),this.parentIndex},Object.defineProperty(e.prototype,"xpath",{get:function(){return this.vnode.xpath},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullXpath",{get:function(){return this.vnode.fullXpath},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skeleton",{get:function(){return this.vnode.skeleton},enumerable:!1,configurable:!0}),e.prototype.info=function(e){return void 0===e&&(e=!0),e&&this.inferParentIndex(),{skeleton:this.skeleton,fullXpath:this.fullXpath,xpath:this.xpath,content:this.content,href:this.href,index:this.parentIndex||this.index}},e.prototype.traceable=function(){if(this.ignore)return!1;if(this.direct){if("click"===this.action||"hover"===this.action){if(-1!==Rt.UNSUPPORTED_CLICK_TAGS.indexOf(this.target.tagName))return!1;if("INPUT"===this.target.tagName&&!(0,Lt.clickableInput)(this.target))return!1;if(!(0,Lt.isContainerTag)(this.target)&&!(0,Lt.depthInside)(this.target,5))return!1}return!0}return this.vnode.container},e.prototype.trackNodes=function(){if(!this.traceable())return[];var e=[this];if("submit"!==this.action)for(var t=this.parentElement;t;){if(t.ignore)return[];t.traceable()&&e.unshift(t),t=t.parentElement}var n=void 0;return e.map((function(e){var t=e.info(!1),i=t.index;return!n&&i&&(n=i),At(At({},t),{index:n||i})}))},Object.defineProperty(e.prototype,"parentElement",{get:function(){var t=this.target.parentNode;if(t&&t.nodeName&&!(0,Lt.isRootNode)(t))return new e(t,this.action,!1)},enumerable:!1,configurable:!0}),e}(),Gt=Xe.default=Ut,qt=function(){function e(e){this.handler=e;var t=navigator.userAgent,n=/chrome/i.exec(t),i=/android/i.exec(t);this.hasTouch="ontouchstart"in window&&!(n&&!i)}return e.prototype.main=function(){for(var e=this.hasTouch?["touchstart"]:["mousedown"],t=this.hasTouch?["touchend","touchcancel"]:["mouseup","mouseleave"],n=this.hasTouch?["touchmove"]:["mousemove"],i=0,r=e;r.length>i;i++)ie(window,r[i],this.touchStartHandler.bind(this));for(var o=0,a=n;a.length>o;o++)ie(window,a[o],this.touchMoveHandler.bind(this));for(var s=0,u=t;u.length>s;s++)ie(window,u[s],this.touchStopHandler.bind(this))},e.prototype.touchStartHandler=function(e){if(1>=e.which){var t=+Date.now();this.safeguard!==t&&(this.touchTimeout&&clearTimeout(this.touchTimeout),this.safeguard=t,this.touchEvent={time:t,target:e.target,x:this._page("x",e),y:this._page("y",e),isTrusted:!0,type:"click"})}},e.prototype.touchMoveHandler=function(e){var t=Math.abs(this._page("x",e)-(this.touchEvent&&this.touchEvent.x)||0),n=Math.abs(this._page("y",e)-(this.touchEvent&&this.touchEvent.y)||0);(t>10||n>10)&&(this.touchEvent=null)},e.prototype.touchStopHandler=function(e){var t=this,n=+Date.now()-(this.touchEvent&&this.touchEvent.time)||0;this.touchEvent&&200>n?this.touchTimeout=setTimeout((function(){t.handler(t.touchEvent),t.touchEvent=null}),200):this.touchEvent&&n>=200&&700>n&&(this.handler(this.touchEvent),this.touchEvent=null)},e.prototype._page=function(e,t){return(this.hasTouch?t.touches[0]:t)["page".concat(e.toUpperCase())]},e}(),Ht={name:"gioEventAutoTracking",method:function(e){var t=this;this.growingIO=e,this.main=function(){ie(document,"submit",t._handleAction),ie(document,"change",t._handleAction),t.growingIO.vdsConfig.touch?new qt(t._handleAction).main():ie(document,"click",t._handleAction)},this._handleAction=function(e,i){var r=t.growingIO,o=r.vdsConfig,a=r.emitter;if(!o.autotrack)return!1;var s=e.target;if(!s)return!1;var u=new Gt(s,e.type,!0).trackNodes();if("click"!==e.type&&(u=Q(R(u))?[]:[R(u)]),Q(u))return!1;null==a||a.emit("onComposeBefore",{event:i,params:null!=e?e:{}}),u.forEach((function(i){var r=i.fullXpath,a=i.index,s=i.content,u=i.href;if(!W(i.fullXpath||"","/div#__vconsole")&&!W(i.fullXpath||"","/div#__giokit")&&(o.debug&&console.log("Action：",e.type,Date.now()),r)){var c=t.growingIO.dataStore,d=c.eventContextBuilder,l=c.eventConverter,g=c.currentPage;l(n(n({eventType:w[e.type],element:[{xpath:r,index:a,textValue:s,hyperlink:u}]},d()),{pageShowTimestamp:g.time}))}}))}}},Bt=["VIEW_CLICK","VIEW_CHANGE","FORM_SUBMIT","PAGE","CUSTOM","LOGIN_USER_ATTRIBUTES"],jt=["LOGIN_USER_ATTRIBUTES"],Kt={name:"gioHybridAdapter",method:function(e){var t=this;this.growingIO=e,this.penetrateHybrid=!0,this.onOptionsInit=function(){var e=t.growingIO,n=e.vdsConfig,i=e.emitter;T(n.penetrateHybrid)&&(t.penetrateHybrid=n.penetrateHybrid),t._initHybridBridge()&&(t.onSendBefore=t.sendBeforeListener,t.hybridConfig.projectId===t.growingIO.vdsConfig.projectId&&(t.growingIO.useHybridInherit=!0)),t.growingIO.useHybridInherit&&(null==i||i.on(Le,(function(e){var n=e.newUserId,i=e.oldUserId,r=e.userKey;t.penetrateHybrid&&(!n&&i?r?t._clearNativeUserIdAndUserKey():t._clearNativeUserId():r?t._setNativeUserIdAndUserKey(B(n),B(r)):t._setNativeUserId(B(n)))})),null==i||i.on(ke,(function(e){var n=e.newUserKey,i=e.oldUserKey,r=e.userId;t.penetrateHybrid&&(!n&&i?t._clearNativeUserIdAndUserKey():t._setNativeUserIdAndUserKey(B(r),B(n)))})))},this._initHybridBridge=function(){var e,n,i,r=!1;return t.hasHybridBridge=!!window.GrowingWebViewJavascriptBridge,t.hasHybridBridge?((null===(e=null===window||void 0===window?void 0:window.GrowingWebViewJavascriptBridge)||void 0===e?void 0:e.configuration)||(window.GrowingWebViewJavascriptBridge.configuration=JSON.parse(window.GrowingWebViewJavascriptBridge.getConfiguration())),(null===(n=null===window||void 0===window?void 0:window.GrowingWebViewJavascriptBridge)||void 0===n?void 0:n.configuration)&&(t.hybridConfig=null===(i=null===window||void 0===window?void 0:window.GrowingWebViewJavascriptBridge)||void 0===i?void 0:i.configuration),r=!0):Pt.consoleText("gioHybridAdapter：当前不存在 GrowingWebViewJavascriptBridge，Web模式。","info"),r},this.sendBeforeListener=function(e){var i=e.requestData;if(t.hasHybridBridge){var r=t.processAttributes(n({},i));q(Bt,r.eventType)&&(q(jt,r.eventType)?t.penetrateHybrid&&t._dispatchEvent(r):(t.penetrateHybrid||Z(r,["userId","userKey","cs1"]),t._dispatchEvent(r)))}},this.processAttributes=function(e){return z(e,(function(t,n){N(t)||x(t)?z(e[n],(function(t,i){N(t)||x(t)?e[n][i]=JSON.stringify(t):e[n][i]=B(t)})):e[n]=B(t)})),e},this._setNativeUserId=function(e){te((function(){return window.GrowingWebViewJavascriptBridge.setNativeUserId(e)}))},this._clearNativeUserId=function(){te((function(){return window.GrowingWebViewJavascriptBridge.clearNativeUserId()}))},this._setNativeUserIdAndUserKey=function(e,t){te((function(){return window.GrowingWebViewJavascriptBridge.setNativeUserIdAndUserKey(e,t)}))},this._clearNativeUserIdAndUserKey=function(){te((function(){return window.GrowingWebViewJavascriptBridge.clearNativeUserIdAndUserKey()}))},this._dispatchEvent=function(e){te((function(){var t;return null===(t=window.GrowingWebViewJavascriptBridge)||void 0===t?void 0:t.dispatchEvent(JSON.stringify(e))}))};var i=this.growingIO,r=i.emitter,o=i.utils;Pt=o,r.on(Pe,this.onOptionsInit)}},Wt=["i","span","em","b","strong","svg"];!function(e){e[e.OUTER=0]="OUTER",e[e.INNER_COVERED=1]="INNER_COVERED",e[e.INNER_SHOW=2]="INNER_SHOW"}(Dt||(Dt={}));var Mt,Vt=i(["HR","BR","SCRIPT","NOSCRIPT","STYLE","HEAD","BASE","LINK","META","TITLE","BODY","HTML","TEMPLATE","CODE"],ze.UNSUPPORTED_CLICK_TAGS,!0),Ft=["SELECT","A","BUTTON","INPUT","IMG","FORM"],Xt=function(e,t,n){return document.elementFromPoint(t,n)===e},zt=function(){function e(e,t,n){this.node=e,this.parentNodeDesc=t,this.devicesInfo=n,this.proxy=new Gt(e),this.tagName=this.node.tagName,this.name=this.tagName.toLowerCase(),this.isIgnore=!!this.node.dataset.growingIgnore,this.isUnSupported=-1!==Vt.indexOf(this.tagName),this.rect=this.computeWindowRect()}return e.prototype.info=function(){var e=this.desc();e.zLevel+=this.devicesInfo.webviewZLevel;var t=this.getDeviceRect(this.rect);return Z(e,"isContainer"),n(n(n({},e),t),{parentXPath:this.parentNodeDesc.isContainer?this.parentNodeDesc.xpath:void 0,href:this.proxy.href,content:this.proxy.content,nodeType:this.nodeType()})},e.prototype.nodeType=function(){return"input"!==this.name||Je.changeableInput(this.node)?this.node.tagName:"INPUT_BTN"},e.prototype.desc=function(){return{index:this.parentNodeDesc.index||this.proxy.index,zLevel:this.zLevel(),xpath:this.proxy.xpath,isContainer:this.isDefinedContainer()}},e.prototype.cssVisible=function(){var e=this.computedStyle();return Number(e.opacity)>0&&"visible"===e.visibility&&"none"!==e.display},e.prototype.viewportStatus=function(){var e=this.rect,t=e.top,n=e.left,i=e.width,r=e.height,o=this.devicesInfo,a=o.winWidth,s=o.winHeight;if(0>=i||0>=r)return Dt.OUTER;var u=this.node;return s>t&&a>n&&i>0&&r>0?Xt(u,n+i/2,t+r/2)||Xt(u,n+1,t+1)||Xt(u,n+i-1,t+1)||Xt(u,n+1,t+r-1)||Xt(u,n+i-1,t+r-1)?Dt.INNER_SHOW:Dt.INNER_COVERED:Dt.OUTER},e.prototype.isCircleable=function(){return this.proxy.target===this.proxy.origin&&(!!this.isDefinedContainer()||!("input"===this.name&&this.node instanceof HTMLInputElement&&"password"===this.node.type)&&(-1!==Ft.indexOf(this.name)||(Je.isLeaf(this.node)?!this.isBigBlank():this.hasBackgroundImage()&&Je.depthInside(this.node,4))))},e.prototype.isSimpleContainer=function(){return"select"===this.name||this.isDefaultContainer()&&(function(e,t){if(0===e.children.length)return!1;for(var n=0,i=H(e.children);n<i.length;n++){var r=i[n];if(-1===t.indexOf(r.tagName.toLowerCase()))return!1}return!0}(this.node,Wt)||!this.node.childElementCount)},e.prototype.isDefinedContainer=function(){var e;return b(this.isContainer)?this.isDefaultContainer()||this.isMarkContainer()||Je.isParentOfLeaf(this.node)&&(!!(null===(e=this.node.innerText)||void 0===e?void 0:e.trim().length)||function(e){var t=e.attributes;if(t.length>0)for(var n=0;n<t.length;n++){var i=t[n].value;if(i&&"false"!==i)return!0}return!1}(this.node))||"select"===this.name:!!this.isContainer},e.prototype.isDefaultContainer=function(){return-1!==ze.SUPPORTED_CONTAINER_TAGS.indexOf(this.tagName)||Je.clickableInput(this.node)},e.prototype.isMarkContainer=function(){return this.node.hasAttribute("data-growing-container")||this.node.hasAttribute("growing-container")},e.prototype.isBigBlank=function(){var e,t,n=null!==(t=null===(e=this.node.innerText)||void 0===e?void 0:e.trim().length)&&void 0!==t?t:0,i=this.rect,r=i.width,o=i.height,a=this.devicesInfo,s=a.winWidth,u=a.winHeight;return!n&&(r>s>>1||o>u>>1)},e.prototype.hasBackgroundImage=function(){var e=this.computedStyle().backgroundImage;return!!e&&"none"!==e&&e.length>0},e.prototype.zLevel=function(){var e=this.computedStyle(),t=e.zIndex;if("auto"!==t)return Number(t||"0")+this.parentNodeDesc.zLevel;switch(e.position){case"relative":return this.parentNodeDesc.zLevel+2;case"sticky":return this.parentNodeDesc.zLevel+3;case"absolute":return this.parentNodeDesc.zLevel+4;case"fixed":return this.parentNodeDesc.zLevel+5;default:return this.parentNodeDesc.zLevel+1}},e.prototype.computeWindowRect=function(){if(this.rect)return this.rect;var e=this.node.getBoundingClientRect(),t=e.top,n=e.bottom,i=e.left,r=e.right-i,o=n-t;return 0>t?o=t+o:t+o>this.devicesInfo.winHeight&&(o=this.devicesInfo.winHeight-t),0>i?r=i+r:i+r>this.devicesInfo.winWidth&&(r=this.devicesInfo.winWidth-i),this.rect={top:t,left:i,width:r,height:o},this.rect},e.prototype.computedStyle=function(){return window.getComputedStyle(this.node)},e.prototype.getDeviceRect=function(e){var t=this.devicesInfo,n=t.scale,i=t.webviewTop,r=t.webviewLeft;return{top:e.top*n+i,left:e.left*n+r,width:e.width*n,height:e.height*n}},e}(),Jt=["DOMContentLoaded","onreadystatechange"],Zt=["scroll","resize","load","beforeunload","popstate","hashchange","pagehide","unload"],Qt=function(){function e(e){this.growingIO=e,this.addDomChangeListener()}return e.prototype.getDomTree=function(e,t,n,i,r,o){var a=function(e,t,n,i,r){var o=document.documentElement.clientWidth;return{winWidth:o,winHeight:document.documentElement.clientHeight,scale:n/o,webviewTop:t,webviewLeft:e,webviewWidth:n,webviewHeight:i,webviewZLevel:r}}(e,t,n,i,r),s=this.getElementsByParent(o||document.body,{isContainer:!1,zLevel:0},a),u=this.growingIO.dataStore.currentPage;return{page:{domain:u.domain,path:u.path,query:u.query,title:u.title},elements:s}},e.prototype.getElementsByParent=function(e,t,n){var i=this,r=[];return[].slice.call(e.childNodes,0).filter((function(e){return 1===e.nodeType})).forEach((function(e){var o=new zt(e,t,n);if(o.cssVisible()&&!o.isIgnore){switch(o.viewportStatus()){case Dt.INNER_SHOW:o.isCircleable()&&r.push(o.info());break;case Dt.INNER_COVERED:o.isDefaultContainer()&&r.push(o.info())}o.isSimpleContainer()||[].push.apply(r,i.getElementsByParent(e,o.desc(),n))}})),r},e.prototype.addDomChangeListener=function(){var e,t=function(t){return void 0===t&&(t=""),function(){var n;"beforeunload"===t&&e&&e.disconnect(),null===(n=window.GrowingWebViewJavascriptBridge)||void 0===n||n.onDomChanged()}};(e=new MutationObserver(t("mutation"))).observe(document.body,{attributes:!0,characterData:!0,childList:!0,subtree:!0}),Jt.forEach((function(e){ie(document,e,t(e))})),Zt.forEach((function(e){ie(window,e,t(e))}))},e}(),Yt=function(){function e(t){var n,i=this;this.growingIO=t,null===(n=this.growingIO.emitter)||void 0===n||n.on(De,(function(){if(window.GrowingWebViewJavascriptBridge){var t=i;window.GrowingWebViewJavascriptBridge.getDomTree=function(){if(arguments.length>=4)return e.bindGetDomTree(t.growingIO),e.domHelper.getDomTree.apply(e.domHelper,arguments)}}}))}return e.bindGetDomTree=function(e){this.domHelper||(this.domHelper=new Qt(e),window.GrowingWebViewJavascriptBridge.getDomTree=this.domHelper.getDomTree.bind(this.domHelper))},e}(),$t={name:"gioHybridCircle",method:Yt},en={name:"gioImpressionTracking",method:function(e){var t,n=this;this.growingIO=e,this.documentReady=!1,this.main=function(e){"listener"===e?(n.documentReady=!0,n.growingIO.gioSDKInitialized&&n.initMutationObserver()):"emitter"===e&&n.documentReady&&n.initMutationObserver()},this.initIntersectionObserver=function(){n.intersectionObserver=new IntersectionObserver((function(e){Q(e)||e.map((function(e){var t=e.target.dataset;if(e.intersectionRatio>0){var i=n.getImpressionProperties(t),r=i.eventId,o=i.properties,a=i.items,s=t.id;if(s){if("once"===t.gioImpType&&F(n.sentImps,s))return;n.sentImps[s]={eventId:r,properties:o,items:a}}r&&n.growingIO.track(r,o,a)}}))}))},this.initMutationObserver=function(){if(n.mutationObserver)return!1;var e=document.querySelectorAll("[data-gio-imp-track]");H(e).map((function(e){var t;null===(t=n.intersectionObserver)||void 0===t||t.observe(e)})),n.mutationObserver=new MutationObserver((function(e){return e.map((function(e){var t;if("attributes"===e.type&&e.target.dataset.gioImpTrack)return null===(t=n.intersectionObserver)||void 0===t?void 0:t.observe(e.target)}))})),n.mutationObserver.observe(document.body,{attributes:!0,childList:!0,subtree:!0,attributeOldValue:!0,attributeFilter:["data-gio-imp-track","data-gio-imp-attrs","data-gio-imp-items",/^data-gio-track-[a-z]+$/i]})},this.getImpressionProperties=function(e){var t={eventId:void 0,properties:{}};if(!(null==e?void 0:e.gioImpTrack))return t;if(t.eventId=e.gioImpTrack,F(e,"gioImpAttrs"))t.properties=te((function(){return N(e.gioImpAttrs)?e.gioImpAttrs:JSON.parse(e.gioImpAttrs)})),t.items=te((function(){return N(e.gioImpItems)?e.gioImpItems:JSON.parse(e.gioImpItems)}));else{var n=/^gioTrack(.+)/;for(var i in e){var r=void 0,o=i.match(n);o&&"track"!==(r=K(o[1]))&&(t.properties[r]=e[i])}}return t.properties=ne(t.properties),t.items=ne(t.items),/^\w+$/.test(t.eventId)&&!Number.isInteger(Number(D(t.eventId.split(""))))||(t.eventId=null,t={}),t},this.sentImps={},window.ActiveXObject||"ActiveXObject"in window||navigator.userAgent.indexOf("compatible")>-1&&navigator.userAgent.indexOf("MSIE")>-1||navigator.userAgent.indexOf("Trident")>-1&&navigator.userAgent.indexOf("rv:11.0")>-1?ee("IE浏览器不支持半自动埋点，gioImpressionTracking已自动关闭！","warn"):(this.initIntersectionObserver(),ie(document,"readystatechange",(function(){q(["interactive","complete"],document.readyState)&&n.main("listener")}),{once:!0}),null===(t=this.growingIO.emitter)||void 0===t||t.on(De,(function(){return n.main("emitter")})),ie(window,"unload",(function(){var e,t;null===(e=n.intersectionObserver)||void 0===e||e.disconnect(),null===(t=n.mutationObserver)||void 0===t||t.disconnect()})))}},tn={name:"gioWebCircle",method:function(e){var t,n=this;this.growingIO=e,this.injectCircle=function(e,t){var n=document.createElement("link"),i=document.createElement("script");n.rel="stylesheet",n.href=e,i.src=t,document.head.appendChild(n),document.head.appendChild(i)},null===(t=this.growingIO.emitter)||void 0===t||t.on(De,(function(){window.addEventListener("message",(function(e){var t=e.data,i=e.source,r=window.vds;if(t&&i){var o=i.vds,a=t.cssURL,s=t.jsURL;o&&"SDK_INJECT_CIRCLE_SCRIPT"===t.type&&r.projectId===o.projectId&&r.dataSourceId===o.dataSourceId&&n.injectCircle(a,s)}}))}))}},nn=["gioPerformance"],rn=function(e){function n(t){var n=e.call(this,t)||this;return n.growingIO=t,n.growingIO.gioSDKFull=!0,n.pluginsContext={plugins:{gioCompress:Ue,gioCustomTracking:Ge,gioEmbeddedAdapter:Fe,gioEventAutoTracking:Ht,gioHybridAdapter:Kt,gioHybridCircle:$t,gioImpressionTracking:en,gioWebCircle:tn}},n}return t(n,e),n}((function(e){var t,n,i,r,o=this;this.growingIO=e,this.innerPluginInit=function(){var e;nn.forEach((function(e){var t;return Z(null===(t=o.pluginsContext)||void 0===t?void 0:t.plugins,e)})),X(null===(e=o.pluginsContext)||void 0===e?void 0:e.plugins).forEach((function(e){var t,n=null===(t=o.pluginsContext)||void 0===t?void 0:t.plugins[e],i=n.name,r=n.method;U(o.pluginItems,(function(e){return e.name===i}))||o.pluginItems.push({name:K(i||e),method:r||function(e){}})})),Q(o.pluginItems)||o.installAll()},this.install=function(e,t,n){var i,r,a=t||U(o.pluginItems,(function(t){return t.name===e}));if((null===(i=o.growingIO)||void 0===i?void 0:i.plugins)[e])return ee("重复加载插件 ".concat(e," 或插件重名，已跳过加载!"),"warn"),!1;if(!a)return ee("插件加载失败!不存在名为 ".concat(e," 的插件!"),"error"),!1;try{return(null===(r=o.growingIO)||void 0===r?void 0:r.plugins)[e]=new a.method(o.growingIO,n),"cdp"===o.growingIO.gioEnvironment&&t&&ee("加载插件 ".concat(e),"info"),!0}catch(e){return ee("插件加载异常 ".concat(e),"error"),!1}},this.installAll=function(e){(e||o.pluginItems).forEach((function(t){o.install(t.name,e?t:void 0,e?null==t?void 0:t.options:void 0)&&!U(o.pluginItems,(function(e){return e.name===t.name}))&&o.pluginItems.push({name:K(t.name),method:t.method?t.method:function(){}})}))},this.uninstall=function(e){var t;Z(o.pluginItems,e);var n=Z(null===(t=o.growingIO)||void 0===t?void 0:t.plugins,e);return n||ee("卸载插件 ".concat(e," 失败!"),"error"),n},this.uninstallAll=function(){o.pluginItems.forEach((function(e){return o.uninstall(e.name)}))},this.lifeError=function(e,t){return ee("插件执行错误 ".concat(e.name," ").concat(t),"error")},this.onComposeBefore=function(e){o.pluginItems.forEach((function(t){var n,i=null===(n=o.growingIO.plugins[t.name])||void 0===n?void 0:n.onComposeBefore;if(i&&A(i))try{i(e)}catch(e){o.lifeError(t,e)}}))},this.onComposeAfter=function(e){o.pluginItems.forEach((function(t){var n,i=null===(n=o.growingIO.plugins[t.name])||void 0===n?void 0:n.onComposeAfter;if(i&&A(i))try{i(e)}catch(e){o.lifeError(t,e)}}))},this.onSendBefore=function(e){o.pluginItems.forEach((function(t){var n,i=null===(n=o.growingIO.plugins[t.name])||void 0===n?void 0:n.onSendBefore;if(i&&A(i))try{i(e)}catch(e){o.lifeError(t,e)}}))},this.onSendAfter=function(e){o.pluginItems.forEach((function(t){var n,i=null===(n=o.growingIO.plugins[t.name])||void 0===n?void 0:n.onSendAfter;if(i&&A(i))try{i(e)}catch(e){o.lifeError(t,e)}}))},this.pluginsContext={plugins:{}},this.pluginItems=[],null===(t=this.growingIO.emitter)||void 0===t||t.on("onComposeBefore",this.onComposeBefore),null===(n=this.growingIO.emitter)||void 0===n||n.on("onComposeAfter",this.onComposeAfter),null===(i=this.growingIO.emitter)||void 0===i||i.on("onSendBefore",this.onSendBefore),null===(r=this.growingIO.emitter)||void 0===r||r.on("onSendAfter",this.onSendAfter)})),on=function(){function e(e){var t,n=this;this.growingIO=e;var i=this.growingIO.vdsConfig.projectId,r=this.growingIO.storage,o=r.getItem,a=r.setItem,s=r.getKeys,u=r.removeItem;this.getItem=o,this.setItem=a,this.getKeys=s,this.removeItem=u,this.sIdStorageName="".concat(i,"_gdp_session_id"),this.uidStorageName="gdp_user_id_gioenc",this.userIdStorageName="".concat(i,"_gdp_cs1_gioenc"),this.userKeyStorageName="".concat(i,"_gdp_user_key_gioenc"),this.gioIdStorageName="".concat(i,"_gdp_gio_id_gioenc"),null===(t=this.growingIO.emitter)||void 0===t||t.on(Re,(function(){n.growingIO.gioSDKInitialized&&(n.growingIO.dataStore.sendVisit(!0),n.growingIO.dataStore.sendPage(!0))}))}return Object.defineProperty(e.prototype,"sessionId",{get:function(){return this.getItem(this.sIdStorageName)||(this.sessionId=ge(),this.sessionId)},set:function(e){var t,n=this;e||(e=ge());var i=this.getItem(this.sIdStorageName)||this.prevSessionId,r=this.growingIO.vdsConfig.sessionExpires,o=void 0===r?30:r;this.setItem(this.sIdStorageName,e,+Date.now()+60*o*1e3),i!==e&&(this.getKeys().filter((function(e){return/.+_gdp_session_id_.{36}/.test(e)})).forEach((function(e){n.removeItem(e)})),this.setItem(this.growingIO.dataStore.visitStorageName,""),null===(t=this.growingIO.emitter)||void 0===t||t.emit(Re,{newSessionId:e,oldSessionId:i})),this.prevSessionId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uid",{get:function(){return this.getItem(this.uidStorageName)||(this.uid=ge(),this.uid)},set:function(e){var t,n=this.getItem(this.uidStorageName)||this.prevUId;this.setItem(this.uidStorageName,e),n!==e&&(null===(t=this.growingIO.emitter)||void 0===t||t.emit("UID_UPDATE",{newUId:e,oldUId:n})),this.prevUId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userId",{get:function(){return this.getItem(this.userIdStorageName)||""},set:function(e){var t,n,i=this.getItem(this.userIdStorageName)||this.prevUserId;this.setItem(this.userIdStorageName,e),null===(t=this.growingIO.emitter)||void 0===t||t.emit(Le,{newUserId:e,oldUserId:i,userKey:this.userKey}),i!==e&&(null===(n=this.growingIO.emitter)||void 0===n||n.emit("USERID_UPDATE",{newUserId:e,oldUserId:i,userKey:this.userKey})),e&&(this.gioId=e),this.prevUserId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userKey",{get:function(){return this.getItem(this.userKeyStorageName)||""},set:function(e){var t,n,i=this.getItem(this.userKeyStorageName)||this.prevUserKey;this.setItem(this.userKeyStorageName,e),null===(t=this.growingIO.emitter)||void 0===t||t.emit(ke,{newUserKey:e,oldUserKey:i,userId:this.userId}),i!==e&&(null===(n=this.growingIO.emitter)||void 0===n||n.emit("USERKEY_UPDATE",{newUserKey:e,oldUserKey:i,userId:this.userId})),this.prevUserKey=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gioId",{get:function(){return this.getItem(this.gioIdStorageName)||""},set:function(e){var t,n=this.getItem(this.gioIdStorageName)||this.prevGioId;this.setItem(this.gioIdStorageName,e),n!==e&&(null===(t=this.growingIO.emitter)||void 0===t||t.emit("GIOID_UPDATE",{newGioId:e,oldGioId:n})),this.prevGioId=e},enumerable:!1,configurable:!0}),e}(),an=function(e){var t=this;this.growingIO=e,this.main=function(){var e,i=t.growingIO,r=i.sdkVersion,o=i.useEmbeddedInherit,a=i.vdsConfig,s=i.userStore,u=i.dataStore,c=i.trackingId,d=u.currentPage,l=d.path,g=d.query,f={appVersion:a.version,dataSourceId:a.dataSourceId,deviceId:s.uid,domain:o?a.appId:window.location.host,gioId:s.gioId,language:navigator.language,path:l,platform:a.platform,query:g,referralPage:(null===(e=u.lastPageEvent)||void 0===e?void 0:e.referralPage)||"",screenHeight:window.screen.height,screenWidth:window.screen.width,sdkVersion:r,sessionId:s.sessionId,timestamp:+Date.now(),title:document.title.slice(0,255),userId:s.userId};if(a.enableIdMapping&&(f.userKey=s.userKey),Q(a.ignoreFields)||a.ignoreFields.forEach((function(e){Z(f,e)})),o&&!Q(t.minpExtraParams)){var h=n({},f);z(n(n({},f),t.minpExtraParams),(function(e,n){var i;q(a.embeddedIgnore,n)?(f[n]=h[n],"domain"===n&&(f[n]=window.location.host)):f[n]=null!==(i=t.minpExtraParams[n])&&void 0!==i?i:f[n]}))}return f.trackingId=c,f},this.minpExtraParams={}},sn=function(e){var t=this;this.growingIO=e,this.parsePage=function(){var e=t.growingIO.vdsConfig.hashtag,n=location.pathname,i=location.search,r=location.hash,o=r.indexOf("?");t.domain=window.location.host,t.title=document.title.slice(0,255),t.time=+Date.now(),t.path=n,t.query=i,e&&(o>-1?(t.path+=r.slice(0,o),t.query=t.query+"&"+r.slice(o+1)):t.path+=r),t.query&&q(["?","&"],t.query.charAt(0))&&(t.query=t.query.slice(1))},this._getNoHashHref=function(){var e=window.location,t=e.protocol,n=e.host,i=e.pathname,r=e.search;return"".concat(t,"://").concat(n).concat(i).concat(r)},this.pageListener=function(){var e=t.growingIO.vdsConfig.hashtag,n=window.location.href,i=t.lastHref;e||(n=t._getNoHashHref(),i=t.lastNoHashHref),i!==n&&(t.parsePage(),t.buildPageEvent())},this.hookHistory=function(){var e=window.history.pushState,n=window.history.replaceState,i=t;e&&te((function(){return window.history.pushState=function(){e.apply(window.history,arguments),setTimeout(i.pageListener)}})),n&&te((function(){return window.history.replaceState=function(){n.apply(window.history,arguments),setTimeout(i.pageListener)}})),ie(window,"popstate",t.pageListener),t.growingIO.vdsConfig.hashtag&&ie(window,"hashchange",t.pageListener)},this.buildPageEvent=function(e){var i=t.growingIO.dataStore,r=i.lastPageEvent,o=i.eventContextBuilder,a=i.eventConverter,s=n(n({eventType:"PAGE"},o()),{protocolType:location.protocol.substring(0,location.protocol.length-1),referralPage:(null==r?void 0:r.path)===t.path&&(null==r?void 0:r.query)===t.query?null==r?void 0:r.referralPage:(null==r?void 0:r.path)?t.lastHref:document.referrer});Q(e)||(s=n(n({},s),e)),s.timestamp=t.time,a(s),t.lastHref=window.location.href,t.lastNoHashHref=t._getNoHashHref(),t.lastLocation=n({},window.location)},this.title=document.title.slice(0,255),this.lastLocation=n({},window.location)},un={referralPage:document.referrer},cn=function(){function e(e){var t,i,u=this;this.growingIO=e,this.ALLOW_SETTING=n(n({},o),"saas"===this.growingIO.gioEnvironment?s:a),this.allowOptKeys=Object.keys(this.ALLOW_SETTING),this.trackTimers={},this.setSequenceIds=function(e,t){var i=u.growingIO.storage.getItem(u.seqStorageIdName)||{};"gsid"===e?i.globalKey=t:i=n(n({},i),t),u.growingIO.storage.setItem(u.seqStorageIdName,i)},this.initOptions=function(e){var t,i,o,a,s,c,d,l=e.projectId,g=e.dataSourceId,f=e.appId;u.initialDataSourceId=g;var h={};u.allowOptKeys.forEach((function(t){var n=u.ALLOW_SETTING[t].type,i=x(n)?!q(n,Y(e[t])):Y(e[t])!==n;"platform"!==t||q(r,e[t])||(i=!0),i?h[t]=u.ALLOW_SETTING[t].default:"ignoreFields"===t?h.ignoreFields=e.ignoreFields.filter((function(e){return q(I,e)})):(h[t]=e[t],q(["dataCollect","autotrack"],t)&&(h[t]||ee("已关闭".concat(v[t]),"info")))})),h.sessionExpires=Math.round(h.sessionExpires),(S(h.sessionExpires)||1>h.sessionExpires||h.sessionExpires>360)&&(h.sessionExpires=30),h.storageType=h.storageType.toLowerCase(),u.growingIO.vdsConfig=n(n(n({},null!==(t=window.vds)&&void 0!==t?t:{}),h),{projectId:l,dataSourceId:g,appId:f,performance:{monitor:null===(o=null===(i=h.performance)||void 0===i?void 0:i.monitor)||void 0===o||o,exception:null===(s=null===(a=h.performance)||void 0===a?void 0:a.exception)||void 0===s||s,network:null!==(d=null===(c=h.performance)||void 0===c?void 0:c.network)&&void 0!==d&&d}}),window.vds=u.growingIO.vdsConfig,u.seqStorageIdName="".concat(l,"_gdp_sequence_ids"),u.visitStorageName="".concat(l,"_gdp_session_id_sent")},this.setOption=function(e,t){var i,r=u.growingIO,o=r.vdsConfig,a=r.callError,s=r.uploader,c=r.emitter,d=_(e)&&q(p,e),l=d&&typeof t===((null===(i=u.ALLOW_SETTING[e])||void 0===i?void 0:i.type)||"string"),g=n({},o);return d&&l?(o[e]=t,"dataCollect"===e&&g.dataCollect!==t&&(t?(u.sendVisit(!0),u.sendPage()):u.growingIO.clearTrackTimer()),q(["host","scheme"],e)&&(null==s||s.generateHost()),null==c||c.emit("OPTION_CHANGE",{optionName:e,optionValue:t}),window.vds[e]=t,!0):(a("setOption > ".concat(e)),!1)},this.getOption=function(e){var t=u.growingIO,i=t.vdsConfig,r=t.callError;return e&&F(i,B(e))?i[B(e)]:b(e)?n({},i):void r("getOption > ".concat(e))},this.sendVisit=function(e){var t=u.growingIO,n=t.userStore.sessionId,i=t.vdsConfig.dataCollect,r=t.storage;if(i){var o=r.getItem(u.visitStorageName);!e&&n===o||(u.buildVisitEvent(),r.setItem(u.visitStorageName,n))}},this.buildVisitEvent=function(e){var t=u.growingIO.dataStore,i=t.eventContextBuilder,r=t.eventConverter,o=u.lastVisitEvent,a=n(n({eventType:"VISIT"},i()),{referralPage:o.referralPage});Q(e)||(a.session=(null==e?void 0:e.session)||a.session,a.trackingId=null==e?void 0:e.trackingId,a=n(n({},a),e)),(null==o?void 0:o.path)&&(a.title=o.title,a.path=o.path,a.query=o.query,a.timestamp=o.timestamp),r(a)},this.sendPage=function(e){e&&u.currentPage.parsePage(),u.currentPage.buildPageEvent()},this.buildErrorEvent=function(e){var t=u.growingIO.dataStore,i=t.eventContextBuilder;(0,t.eventConverter)(n({eventType:"CUSTOM",pageShowTimestamp:u.currentPage.time,eventName:"onError",attributes:e},i()))},this.currentPage=new sn(this.growingIO),this.eventContextBuilderInst=new an(this.growingIO),this.eventContextBuilder=this.eventContextBuilderInst.main,this.generalProps={},this.lastVisitEvent=un,null===(t=this.growingIO.emitter)||void 0===t||t.on("onComposeAfter",(function(e){var t=e.composedEvent;"VISIT"!==t.eventType&&"vst"!==t.t||t.trackingId!==u.growingIO.trackingId||(u.lastVisitEvent=t)})),this.lastPageEvent={},null===(i=this.growingIO.emitter)||void 0===i||i.on("onComposeAfter",(function(e){var t=e.composedEvent;"PAGE"!==t.eventType&&"page"!==t.t||t.trackingId!==u.growingIO.trackingId||(u.lastPageEvent=t)}))}return Object.defineProperty(e.prototype,"esid",{get:function(){var e=this,t=this.growingIO.storage.getItem(this.seqStorageIdName)||{},i=n({},t);return Z(i,"globalKey"),i=N(i)&&!b(i)?i:{},this._esid={},X(i).forEach((function(t){e._esid[t]=S(Number(i[t]))||i[t]>=1e9||1>i[t]?1:i[t]})),this._esid},set:function(e){var t={};X(e).forEach((function(n){t[n]=S(e[n])||e[n]>=1e9||1>e[n]?1:e[n]})),J(this._esid,t)||(this._esid=t,this.setSequenceIds("esid",this._esid))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gsid",{get:function(){var e=this.growingIO.storage.getItem(this.seqStorageIdName)||{},t=Number(e.globalKey);return this._gsid=S(t)||t>=1e9||1>t?1:t,this._gsid},set:function(e){S(Number(e))||e>=1e9||1>e?this._gsid=1:this._gsid=e,this.setSequenceIds("gsid",this._gsid)},enumerable:!1,configurable:!0}),e}(),dn=function(e){function i(t){var i=e.call(this,t)||this;return i.growingIO=t,i.eventConverter=function(e){var t,r,o=i.growingIO,a=o.vdsConfig,s=o.dataStore,u=o.uploader;if(a.dataCollect){e.trackingId===i.growingIO.trackingId&&(e.globalSequenceId=s.gsid,e.eventSequenceId=s.esid[e.eventType]||1);var c={};z(e,(function(e,t){var n;if("element"===t){var i=null!==(n=D(e))&&void 0!==n?n:{};z(i,(function(e,t){Q(e)&&0!==e||(c[t]=e)}))}else(Q(e)||b(e))&&0!==e||(c[t]=e)})),e.trackingId===i.growingIO.trackingId&&(i.growingIO.dataStore.gsid+=1,i.growingIO.dataStore.esid=n(n({},i.growingIO.dataStore.esid),((t={})[c.eventType]=(i.growingIO.dataStore.esid[c.eventType]||1)+1,t))),null===(r=i.growingIO.emitter)||void 0===r||r.emit("onComposeAfter",{composedEvent:n({},c)}),e.trackingId===i.growingIO.trackingId&&u.commitRequest(c)}},i}return t(i,e),i}(cn),ln=function(e){function n(t){var n=e.call(this,t)||this;return n.growingIO=t,n.generateHost=function(){var e=n.growingIO.vdsConfig,t=e.scheme,i=e.host,r=void 0===i?"":i,o=e.projectId;t?M(B(t),"://")||(t="".concat(t,"://")):t="".concat(location.protocol.indexOf("http")>-1?location.protocol.replace(":",""):"https","//"),W(r,"http")&&(r=r.substring(r.indexOf("://")+(M(B(t),"://")?3:0))),n.requestURL="".concat(t).concat(r,"/v3/projects/").concat(o,"/collect")},n.requestURL="",n.generateHost(),n}return t(n,e),n}((function(e){var t=this;this.growingIO=e,this.commitRequest=function(e){var i=n({},e);t.requestQueue.push(n(n({},i),{requestType:fe()?"Beacon":"XHR"})),t.initiateRequest()},this.initiateRequest=function(){var e,r,o;if(i([],t.requestQueue,!0).length>0&&t.requestingNum<t.requestLimit){var a=t.growingIO,s=a.vdsConfig,u=a.emitter,c=a.plugins,d=a.useHybridInherit;if(t.requestQueue=i([],t.requestQueue,!0).filter((function(e){return(t.retryIds[e.globalSequenceId||e.esid]||0)<=t.retryLimit})),Q(t.requestQueue))return;var l=t.requestQueue.shift(),g=l.requestType;null==u||u.emit("onSendBefore",{requestData:n({},l)});var f=n({},l);if(Z(f,["requestType","trackingId"]),s.debug&&console.log("[GrowingIO Debug]:",JSON.stringify(f,null,2).replace(/\"/g,(o=window.navigator.userAgent,/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(o)&&!/chrome\/(\d+\.\d+)/i.test(o)?"":'"'))),t.requestingNum+=1,d)return t.requestSuccessFn(l),!1;var h=n({},f);switch(s.compress&&(null===(e=null==c?void 0:c.gioCompress)||void 0===e?void 0:e.compressToUint8Array)?(t.compressType="1",h=null===(r=null==c?void 0:c.gioCompress)||void 0===r?void 0:r.compressToUint8Array(JSON.stringify([h]))):(t.compressType="0",h=JSON.stringify([h])),g){case"Beacon":default:t.sendByBeacon(l,h);break;case"XHR":t.sendByXHR(l,h);break;case"Image":t.sendByImage(l,h)}}},this.generateURL=function(){return"".concat(t.requestURL,"?stm=").concat(+Date.now(),"&compress=").concat(t.compressType)},this.sendByBeacon=function(e,n){navigator.sendBeacon(t.generateURL(),n)?t.requestSuccessFn(e):t.requestFailFn(e,"Beacon")},this.sendByXHR=function(e,n){var i,r=q(["unload","beforeunload","pagehide"],null===(i=null===window||void 0===window?void 0:window.event)||void 0===i?void 0:i.type),o=new XMLHttpRequest;if(o)return o.open("POST",t.generateURL(),r),o.onreadystatechange=function(){4===o.readyState&&204===o.status?t.requestSuccessFn(e):t.requestFailFn(e,"XHR")},o.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),void o.send(n);if(null===window||void 0===window?void 0:window.XDomainRequest){var a=new window.XDomainRequest;a.open("POST",t.generateURL().replace("https://","http://"),r),a.onload=function(){204===a.status?t.requestSuccessFn(e):t.requestFailFn(e,"XHR")},a.onerror=a.ontimeout=function(){t.requestFailFn(e,"XHR")},a.send(n)}},this.sendByImage=function(e,n){var i="".concat(t.generateURL(),"&data=").concat(n),r=document.createElement("img");r.width=1,r.height=1,r.onload=function(){t.requestSuccessFn(e),t.clearImage(r)},r.onerror=r.onabort=function(){t.requestFailFn(e,"Image"),t.clearImage(r)},r.src=i},this.clearImage=function(e){e.src="",e.onload=function(){},e.onerror=e.onerabort=function(){},e=null},this.requestSuccessFn=function(e){var i;t.requestingNum-=1;var r=e.globalSequenceId||e.esid||-1;t.retryIds[r]&&(t.retryIds[r]=0),e.trackingId===t.growingIO.trackingId&&(t.growingIO.userStore.sessionId=e.sessionId),null===(i=t.growingIO.emitter)||void 0===i||i.emit("onSendAfter",{requestData:n({},e)}),t.initiateRequest()},this.requestFailFn=function(e,i){t.requestingNum-=1;var r=e.globalSequenceId||e.esid||-1;t.retryIds[r]||(t.retryIds[r]=0),t.retryIds[r]+=1;var o=t.requestQueue.some((function(t){return t.globalSequenceId===e.globalSequenceId&&t.esid===e.esid})),a=i;if(t.retryIds[r]<t.retryLimit+1||(a="Beacon"===i?"XHR":"XHR"===i?"Image":void 0,t.retryIds[r]=0),!o&&a)var s=window.setTimeout((function(){Q(t.requestQueue)?(t.requestQueue.push(n(n({},e),{requestType:a})),t.initiateRequest()):t.requestQueue.push(n(n({},e),{requestType:a})),window.clearTimeout(s),s=null}),800)},this.requestQueue=[],this.requestLimit=10,this.requestTimeout=5e3,this.retryLimit=1,this.retryIds={},this.requestingNum=0,this.requestURL=""})),gn=function(e){function i(){var t=e.call(this)||this;return t.registerPlugins=function(e){x(e)?(e.forEach((function(t,i){var r,o;Q(t)||b(t)?ee("插件不合法，跳过加载!","warn"):(null===(r=t.js)||void 0===r?void 0:r.default)&&(e[i]=n(n({},null===(o=t.js)||void 0===o?void 0:o.default),{options:t.options}))})),e=k(e),t.plugins.installAll(e)):ee("插件注册失败，请检查!","error")},t.initCallback=function(){t.uploader=new ln(t),t.userStore=new on(t)},t.getPlugins=function(){return t.plugins.pluginItems},t.setTrackerScheme=function(e){q(["http","https"],e)?(t.dataStore.setOption("scheme",e),t.notRecommended()):t.callError("scheme",!1)},t.setTrackerHost=function(e){se.test(e)||ue.test(e)?(t.dataStore.setOption("host",e),t.notRecommended()):t.callError("host",!1)},t.setDataCollect=function(e){t.setOption("dataCollect",!!e),t.notRecommended()},t.setAutotrack=function(e){t.setOption("autotrack",!!e),t.notRecommended()},t.enableDebug=function(e){t.setOption("debug",!!e),t.notRecommended()},t.enableHT=function(e){t.setOption("hashtag",!!e),t.notRecommended()},t.getVisitorId=function(){return t.userStore.uid},t.getDeviceId=function(){return t.userStore.uid},t.setUserAttributes=function(e,n){var i,r;!Q(e)&&N(e)?null===(r=null===(i=t.plugins)||void 0===i?void 0:i.gioCustomTracking)||void 0===r||r.buildUserAttributesEvent(e,n):t.callError("setUserAttributes")},t.setUserId=function(e,n){if(ae(B(e).trim())){var i=t.userStore.gioId;t.vdsConfig.enableIdMapping&&(t.userStore.userKey=!b(n)&&B(n).length>0?B(n).slice(0,1e3):""),t.userStore.userId=B(e).slice(0,1e3),i&&i!==t.userStore.userId&&(t.userStore.sessionId="")}else t.clearUserId(),t.callError("setUserId")},t.clearUserId=function(){t.userStore.userId="",t.userStore.userKey=""},t.track=function(e,i,r,o){var a,s;((null===(s=null===(a=t.plugins)||void 0===a?void 0:a.gioCustomTracking)||void 0===s?void 0:s.buildCustomEvent)||function(){})(e,n(n({},t.dataStore.generalProps),N(i)&&!Q(i)?i:{}),r,o)},t.sendPage=function(e){return t.dataStore.currentPage.buildPageEvent(e)},t.sendVisit=function(e){return t.dataStore.buildVisitEvent(e)},t.trackTimerStart=function(e,n){t.vdsConfig.dataCollect&&re(e,(function(){var i=ge();A(n)?(t.dataStore.trackTimers[i]={eventName:e,leng:0,start:+Date.now()},n(i)):ee("回调方法不合法，返回timerId失败!")}))},t.trackTimerPause=function(e){if(e&&t.dataStore.trackTimers[e]){var n=t.dataStore.trackTimers[e];n.start&&(n.leng=n.leng+(+Date.now()-n.start)),n.start=0}},t.trackTimerResume=function(e){if(e&&t.dataStore.trackTimers[e]){var n=t.dataStore.trackTimers[e];0===n.start&&(n.start=+Date.now())}},t.trackTimerEnd=function(e,i){if(t.vdsConfig.dataCollect)if(e&&t.dataStore.trackTimers[e]){var r=t.dataStore.trackTimers[e];if(0!==r.start){var o=+Date.now()-r.start;r.leng=o>0?r.leng+o:0}t.track(r.eventName,n(n({},i),{event_duration:r.leng>864e5?0:r.leng/1e3})),t.removeTimer(e)}else ee("未查找到对应的计时器，请检查!","error")},t.removeTimer=function(e){e&&t.dataStore.trackTimers[e]&&delete t.dataStore.trackTimers[e]},t.clearTrackTimer=function(){t.dataStore.trackTimers={}},t.dataStore=new dn(t),t}return t(i,e),i}((function(){var e,t=this;this.trackingId="g0",this.init=function(e){var n,i,r,o,a;ee("Gio Web SDK 初始化中...","info");var s=t.dataStore,u=s.initOptions,c=s.currentPage,d=s.sendVisit,l=s.sendPage;u(e),t.storage=xe(t.vdsConfig),t.initCallback(),null===(n=t.emitter)||void 0===n||n.emit(Pe,t),null===(r=null===(i=t.plugins)||void 0===i?void 0:i.gioEventAutoTracking)||void 0===r||r.main(),c.hookHistory(),c.parsePage(),null===(o=t.emitter)||void 0===o||o.emit(De,t),ee("Gio Web SDK 初始化完成！","success"),t.useEmbeddedInherit||d(),l(),t.gioSDKInitialized=!0,t.vdsConfig.gioSDKInitialized=!0,window[t.vds]=t.vdsConfig,null===(a=t.emitter)||void 0===a||a.emit("SDK_INITIALIZED_COMPLATE",t)},this.setOption=function(e,n){if(q(p,e)){var i=t.dataStore.setOption(e,n);return i&&v[e]&&ee("已".concat(n?"开启":"关闭").concat(v[e]),"info"),i}return ee("不存在可修改的配置项：".concat(e,"，请检查后重试!"),"warn"),!1},this.getOption=function(e){return t.dataStore.getOption(e)},this.setGeneralProps=function(e){N(e)&&!Q(e)?(t.dataStore.generalProps=n(n({},t.dataStore.generalProps),e),X(t.dataStore.generalProps).forEach((function(e){q([void 0,null],t.dataStore.generalProps[e])&&(t.dataStore.generalProps[e]="")}))):t.callError("setGeneralProps")},this.clearGeneralProps=function(e){x(e)&&!Q(e)?e.forEach((function(e){Z(t.dataStore.generalProps,e)})):t.dataStore.generalProps={}},this.reissuePage=function(){t.dataStore.sendPage()},this.notRecommended=function(){return ee("不推荐的方法使用，建议使用 gio('setOption', [optionName], [value])!","info")},this.callError=function(e,t,n){return void 0===t&&(t=!0),void 0===n&&(n="参数不合法"),ee("".concat(t?"调用":"设置"," ").concat(e," 失败，").concat(n,"!"),"warn")},this.gioEnvironment="cdp",this.sdkVersion="3.8.5",this.vds=window.gioCompatibilityVds?"gdp_vds":"vds",this.utils=n(n(n({},$),oe),{qs:qe}),this.emitter={all:e=e||new Map,on:function(t,n){var i=e.get(t);i?i.push(n):e.set(t,[n])},off:function(t,n){var i=e.get(t);i&&(n?i.splice(i.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var i=e.get(t);i&&i.slice().map((function(e){e(n)})),(i=e.get("*"))&&i.slice().map((function(e){e(t,n)}))}},this.useEmbeddedInherit=!1,this.useHybridInherit=!1,this.gioSDKInitialized=!1,this.plugins=new rn(this),this.plugins.innerPluginInit()}));return function(){var e,t,i,r,o,a=window.gioCompatibilityVds?"gdp_vds":"vds";if(null===(e=window[a])||void 0===e?void 0:e.gioSDKInstalled)return Mt=window.gdp,void ee("SDK重复加载，请检查是否重复加载SDK或接入其他平台SDK导致冲突!","warn");window[a]=n(n({},null!==(t=window[a])&&void 0!==t?t:{}),{gioSDKInstalled:!0});var s=new gn;Mt=function(){var e,t=arguments[0];if(_(t)&&q(h,t)&&s[t]){var i=L(H(arguments));if("init"===t){var r=function(e){var t;return e.vdsConfig||e.gioSDKInitialized||(null===(t=window.vds)||void 0===t?void 0:t.gioSDKInitialized)?(ee("SDK重复初始化，请检查是否重复加载SDK或接入其他平台SDK导致冲突!","warn"),!1):!(q(["","localhost","127.0.0.1"],location.hostname)&&!window._gr_ignore_local_rule&&(ee("当前SDK不允许在本地环境初始化!","warn"),1))}(s);if(!r)return;var o=function(e){return!Q(k(e))||(ee('SDK初始化失败，请使用 gdp("init", "您的GrowingIO项目 accountId", "您项目的 dataSourceId", options); 进行初始化!',"error"),!1)}(i);if(!o)return;var u=function(e){var t=D(e),n=R(e);return ae(B(t).trim())?(N(n)&&n||(n={}),{projectId:t,userOptions:n}):(ee("SDK初始化失败，accountId 参数不合法!","error"),!1)}(i);if(!u)return;var c=function(e){var t=e[1],n=e[2],i=R(e);return t&&_(t)?{dataSourceId:t,appId:_(n)?n:"",cdpOptions:i}:(ee("SDK初始化失败，dataSourceId 参数不合法!","error"),!1)}(i);if(!c)return;var d=u.projectId,l=c.dataSourceId,g=c.appId,f=c.cdpOptions;s.init(n(n({},f),{projectId:d,dataSourceId:l,appId:g}))}else if("registerPlugins"===t)s.registerPlugins(i[0]);else{if(s.gioSDKInitialized&&s.vdsConfig)return s[t].apply(s,i);ee("SDK未初始化!","error")}}else q(m,t)?ee("方法 ".concat(B(t)," 已被弃用，请移除!"),"warn"):ee("不存在名为 ".concat(B(t)," 的方法调用!"),"error");window[a]=n(n({},window[a]),{_gr_ignore_local_rule:null!==(e=window._gr_ignore_local_rule)&&void 0!==e&&e,gioEnvironment:"cdp",gioSDKVersion:s.sdkVersion,gioSDKFull:s.gioSDKFull,canIUse:function(e){return q(h,e)&&s[e]}})};var u=null===(i=null===window||void 0===window?void 0:window.gdp)||void 0===i?void 0:i.q,c=null===(r=null===window||void 0===window?void 0:window.gdp)||void 0===r?void 0:r.e,d=null===(o=null===window||void 0===window?void 0:window.gdp)||void 0===o?void 0:o.ef;window.gdp=Mt,window.gdp.e=c,window.gdp.ef=d,x(u)&&!Q(u)&&u.forEach((function(e){Mt.apply(null,e)}))}(),Mt}));
