function e(e,o,i){if(i||2===arguments.length)for(var n,t=0,r=o.length;r>t;t++)!n&&t in o||(n||(n=[].slice.call(o,0,t)),n[t]=o[t]);return e.concat(n||[].slice.call(o))}var o=function(e){return n(["undefined","null"],g(e))},i=function(e){return"object"===g(e)&&!o(e)},n=function(e,o){return("array"===g(e)||"string"===g(e))&&e.indexOf(o)>=0},t={}.hasOwnProperty,r=function(e,i){return!o(e)&&t.call(e,i)},a=function(e){return i(e)?Object.keys(e):[]},g=function(e){return{}.toString.call(e).slice(8,-1).toLowerCase()},s={},c={}.hasOwnProperty;function d(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function l(e){try{return encodeURIComponent(e)}catch(e){return null}}s.stringify=function(e,o){o=o||"";var i,n,t=[];for(n in"string"!=typeof o&&(o="?"),e)if(c.call(e,n)){if((i=e[n])||null!=i&&!isNaN(i)||(i=""),n=l(n),i=l(i),null===n||null===i)continue;t.push(n+"="+i)}return t.length?o+t.join("&"):""},s.parse=function(e){for(var o,i=/([^=?#&]+)=?([^&]*)/g,n={};o=i.exec(e);){var t=d(o[1]),r=d(o[2]);null===t||null===r||t in n||(n[t]=r)}return n};var u={gioprojectid:"projectId",giodatacollect:"dataCollect",gioappid:"domain",giodatasourceid:"dataSourceId",gios:"sessionId",giou:"uid",giocs1:"userId",giouserkey:"userKey",gioappchannel:"appChannel",giodevicebrand:"deviceBrand",giodevicemodel:"deviceModel",giodevicetype:"deviceType",giolanguage:"language",gionetworkstate:"networkState",giooperatingsystem:"operatingSystem",gioplatform:"platform",gioplatformversion:"platformVersion",gioscreenheight:"screenHeight",gioscreenwidth:"screenWidth"},f=["gioprojectid","giodatacollect","giodatasourceid","gioplatform"],p=["giodatasourceid","gioplatform","gioappchannel","giodevicebrand","giodevicemodel","giodevicetype","giolanguage","gionetworkstate","giooperatingsystem","gioplatformversion","gioscreenheight","gioscreenwidth"],h=["giocs1","gios","giou","giouserkey"],w="gio_search_cookie_gioenc",I={name:"gioEmbeddedAdapter",method:function(o){var t=this;this.growingIO=o,this.main=function(){var e,o=t.growingIO.vdsConfig,c=o.projectId,d=o.appId,l=t.getGQS();if("none"!==t.qsFrom&&l.gioprojectid===c&&l.gioappid===d){t.growingIO.useEmbeddedInherit=!0,(function(e){return Array.isArray(e)&&"array"===g(e)}(e=l)?0!==e.length:i(e)?0!==a(e).length:e)?t.growingIO.storage.setItem(w,s.stringify(l)):t.growingIO.storage.removeItem(w),f.forEach((function(e){r(l,e)&&("giodatacollect"===e?t.growingIO.vdsConfig.dataCollect=n(["true",!0],l.giodatacollect):t.growingIO.vdsConfig[u[e]]=l[e])}));var h=t.growingIO,I=h.userStore,m=h.vdsConfig.sessionExpires,v=h.dataStore.eventContextBuilderInst,y=h.trackingId;I.setUid(l.giou),I.setSessionId(y,l.gios),I.setUserId(y,l.giocs1),I.setUserKey(y,l.giouserkey),window.setInterval((function(){I.setSessionId(y,l.gios)}),.8*m*60*1e3),p.forEach((function(e){r(l,e)&&(v.minpExtraParams[u[e]]=l[e])})),t.growingIO.setUserId=function(){},t.growingIO.clearUserId=function(){},r(l,"giodatacollect")&&(t.growingIO.setOption=function(){})}t.gioURLRewrite()},this.getGQS=function(){var o=t.growingIO.vdsConfig.hashtag,i=t.growingIO.storage.getItem(w),g=window.location.search,c=window.location.hash,d=o?c.substring(c.indexOf("?")+1):"",l=s.parse(g),u=s.parse(d),f=s.parse((i||"").replace("gioenc-","")),I={};if(r(l,"gioprojectid"))I=l,t.qsFrom="search";else if(r(u,"gioprojectid"))I=u,t.qsFrom="hash";else{if(!r(f,"gioprojectid"))return t.qsFrom="none",{};I=f,t.qsFrom="cookie"}var m={},v={},y=e(e(["gioappid","gioprojectid","giodatacollect"],h,!0),p,!0);return a(I).forEach((function(e){var o=e.toLowerCase();n(y,o)?n(["","undefined","null",void 0,null],I[e])||(m[o]=I[e],n(["true","TRUE",!0],I[e])&&(m[o]=!0),n(["false","FALSE",!1],I[e])&&(m[o]=!1)):v[e]=I[e]})),t.gqs=m,t.ngqs=v,m},this.gioURLRewrite=function(){var e=t.growingIO.vdsConfig.hashtag,o=window.location.search,i=window.location.hash,n=!1;if("search"===t.qsFrom&&(o=s.stringify(t.ngqs,!0),n=!0),e&&"hash"===t.qsFrom&&(i="".concat(i.split("?")[0]).concat(s.stringify(t.ngqs,!0)),n=!0),n){var r="".concat(window.location.pathname).concat(o||"").concat(i||"");window.history.replaceState(null,document.title,r)}},this.gqs={},this.ngqs={},this.qsFrom="search",this.growingIO.emitter.on("OPTION_INITIALIZED",(function(){t.main()}))}};export{I as default};
