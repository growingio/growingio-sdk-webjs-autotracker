function e(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;i>o;o++)!n&&o in t||(n||(n=[].slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||[].slice.call(t))}var t,r,n,o,i,a="function"==typeof Array.from?Array.from:(r||(r=1,n=function(e){return"function"==typeof e},o=function(e){var t=function(e){var t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t}(e);return Math.min(Math.max(t,0),9007199254740991)},i=function(e){var t=e.next();return!t.done&&t},t=function(e){var t,r,a,c=this,s=arguments.length>1?arguments[1]:void 0;if(void 0!==s){if(!n(s))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(t=arguments[2])}var g=function(e,t){if(null!=e&&null!=t){var r=e[t];if(null==r)return;if(!n(r))throw new TypeError(r+" is not a function");return r}}(e,function(e){if(null!=e){if(["string","number","boolean","symbol"].indexOf(typeof e)>-1)return Symbol.iterator;if("undefined"!=typeof Symbol&&"iterator"in Symbol&&Symbol.iterator in e)return Symbol.iterator;if("@@iterator"in e)return"@@iterator"}}(e));if(void 0!==g){r=n(c)?Object(new c):[];var u,l,f=g.call(e);if(null==f)throw new TypeError("Array.from requires an array-like or iterable object");for(a=0;;){if(!(u=i(f)))return r.length=a,r;l=u.value,r[a]=s?s.call(t,l,a):l,a++}}else{var d=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var h,p=o(d.length);for(r=n(c)?Object(new c(p)):Array(p),a=0;p>a;)h=d[a],r[a]=s?s.call(t,h,a):h,a++;r.length=p}return r}),t),c=function(e){return u(["undefined","null"],m(e))},s=function(e){return"string"===m(e)},g=function(e){return"object"===m(e)&&!c(e)},u=function(e,t){return("array"===m(e)||"string"===m(e))&&e.indexOf(t)>=0},l=a,f=function(e,t){if(s(e)){var r=e.length,n=r;n>r&&(n=r);var o=n;return(n-=t.length)>=0&&e.slice(n,o)===t}return!1},d={}.hasOwnProperty,h=function(e,t){return!c(e)&&d.call(e,t)},p=function(e){return g(e)?Object.keys(e):[]},m=function(e){return{}.toString.call(e).slice(8,-1).toLowerCase()},v=function(e){try{return e()}catch(e){return}},w=function(e){return f(e,"_gioenc")?e.slice(0,-7):e},y={A:1,a:1,Z:1,z:1,"@":1,"{":1},I=function(e){return(e=e||"").split("").map((function(e){return y[e]?e:O(e)})).join("")},O=function(e){if(/[0-9]/.test(e))return 1^+e;var t=e.charCodeAt(0);return String.fromCharCode(1^t)},S=function(){this.getItem=function(e){var t,r=v((function(){return JSON.parse(localStorage.getItem(w(e))||"")}))||{};return g(r)&&r.expiredAt>+Date.now()?(t=function(e){return s(e)&&(r="gioenc-",s(t=e)&&t.slice(0,7)===r)&&v((function(){return I(e.replace("gioenc-",""))}))||e;var t,r}(r.value),isNaN(Number(t))&&v((function(){return JSON.parse(t)}))||t):void 0},this.setItem=function(e,t,r){var n,o=null!=r?r:+new Date((new Date).getFullYear()+3,(new Date).getMonth(),(new Date).getDay()).getTime();localStorage.setItem(w(e),JSON.stringify({value:s(t)&&t.length&&f(e,"_gioenc")?(n=t,c(n)?n:v((function(){return"gioenc-".concat(I(n))}))||n):t,expiredAt:o}))},this.removeItem=function(e){return localStorage.removeItem(w(e))},this.hasItem=function(e){return!!localStorage.getItem(w(e))},this.getKeys=function(){return l(Array(localStorage.length)).map((function(e,t){return localStorage.key(t)}))},this.type="localStorage"},b={},j={}.hasOwnProperty;function q(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function A(e){try{return encodeURIComponent(e)}catch(e){return null}}b.stringify=function(e,t){t=t||"";var r,n,o=[];for(n in"string"!=typeof t&&(t="?"),e)if(j.call(e,n)){if((r=e[n])||null!=r&&!isNaN(r)||(r=""),n=A(n),r=A(r),null===n||null===r)continue;o.push(n+"="+r)}return o.length?t+o.join("&"):""},b.parse=function(e){for(var t,r=/([^=?#&]+)=?([^&]*)/g,n={};t=r.exec(e);){var o=q(t[1]),i=q(t[2]);null===o||null===i||o in n||(n[o]=i)}return n};var C={gioprojectid:"projectId",giodatacollect:"dataCollect",gioappid:"domain",giodatasourceid:"dataSourceId",gios:"sessionId",giou:"uid",giocs1:"userId",giouserkey:"userKey",gioappchannel:"appChannel",giodevicebrand:"deviceBrand",giodevicemodel:"deviceModel",giodevicetype:"deviceType",giolanguage:"language",gionetworkstate:"networkState",giooperatingsystem:"operatingSystem",gioplatform:"platform",gioplatformversion:"platformVersion",gioscreenheight:"screenHeight",gioscreenwidth:"screenWidth"},E=["gioprojectid","giodatacollect","giodatasourceid","gioplatform"],k=["giodatasourceid","gioplatform","gioappchannel","giodevicebrand","giodevicemodel","giodevicetype","giolanguage","gionetworkstate","giooperatingsystem","gioplatformversion","gioscreenheight","gioscreenwidth"],N=["giocs1","gios","giou","giouserkey"],x="gdp_query_string",F={name:"gioEmbeddedAdapter",method:function(t){var r=this;this.growingIO=t,this.onOptionsInit=function(e,t){var n,o,i,a=t.projectId,c=t.appId,s=e===r.growingIO.trackingId?t.hashtag:r.growingIO.vdsConfig.hashtag,l=r.getGQS(s);if(u(["search","hash"],r.qsFrom)&&!(function(e){return Array.isArray(e)&&"array"===m(e)}(i=l)?0===i.length:g(i)?0===p(i).length:!i)&&r.storage.setItem(x,l),!r.growingIO.useEmbeddedInherit&&"none"!==r.qsFrom&&l.gioprojectid===a&&l.gioappid===c){r.growingIO.useEmbeddedInherit=e;var f=r.growingIO.dataStore.getTrackerVds(e);E.forEach((function(e){h(l,e)&&("giodatacollect"===e?f.dataCollect=u(["true",!0],l.giodatacollect):f[C[e]]=l[e])})),r.growingIO.dataStore.updateVdsConfig(e,f);var d=r.growingIO,v=d.userStore,w=d.dataStore.eventContextBuilderInst;v.setUid(l.giou),v.setSessionId(e,l.gios),v.setUserId(e,null!==(n=l.giocs1)&&void 0!==n?n:""),v.setUserKey(e,null!==(o=l.giouserkey)&&void 0!==o?o:""),window.setInterval((function(){v.setSessionId(e,l.gios)}),.8*t.sessionExpires*60*1e3),k.forEach((function(e){h(l,e)&&(w.minpExtraParams[C[e]]=l[e])}));var y=r.growingIO.setUserId;r.growingIO.setUserId=function(){for(var t=[],r=0;arguments.length>r;r++)t[r]=arguments[r];if(t[0]!==e)return y.apply(this,t)};var I=r.growingIO.clearUserId;if(r.growingIO.clearUserId=function(){for(var t=[],r=0;arguments.length>r;r++)t[r]=arguments[r];if(t[0]!==e)return I.apply(this,t)},h(l,"giodatacollect")){var O=r.growingIO.setOption;r.growingIO.setOption=function(){for(var t=[],r=0;arguments.length>r;r++)t[r]=arguments[r];if(t[0]!==e)return O.apply(this,t)}}}r.gioURLRewrite(),r.growingIO.dataStore.currentPage.parsePage()},this.getGQS=function(t){var n=window.location.search,o=window.location.hash,i=t?o.substring(o.indexOf("?")+1):"",a=r.storage.getItem(x),c=b.parse(n),s=b.parse(i),g=a,l={};if(h(c,"gioprojectid"))l=c,r.qsFrom="search";else if(h(s,"gioprojectid"))l=s,r.qsFrom="hash";else{if(!h(g,"gioprojectid"))return r.qsFrom="none",{};l=g,r.qsFrom="local"}var f={},d={},m=e(e(["gioappid","gioprojectid","giodatacollect"],N,!0),k,!0);return p(l).forEach((function(e){var t=e.toLowerCase();u(m,t)?u(["","undefined","null",void 0,null],l[e])?f[t]="":(f[t]=l[e],u(["true","TRUE",!0],l[e])&&(f[t]=!0),u(["false","FALSE",!1],l[e])&&(f[t]=!1)):d[e]=l[e]})),r.gqs=f,r.customerqs=d,f},this.gioURLRewrite=function(){var e=r.growingIO.vdsConfig.hashtag,t=window.location.search,n=window.location.hash,o=!1;if("search"===r.qsFrom&&(t=b.stringify(r.customerqs,!0),o=!0),e&&"hash"===r.qsFrom&&(n="".concat(n.split("?")[0]).concat(b.stringify(r.customerqs,!0)),o=!0),o){var i="".concat(window.location.pathname).concat(t||"").concat(n||"");window.history.replaceState(null,document.title,i)}},this.pluginVersion="4.2.0",this.gqs={},this.customerqs={},this.qsFrom="search",this.storage=new S,this.growingIO.emitter.on("OPTION_INITIALIZED",(function(e){var t=e.trackingId,n=e.vdsConfig;r.onOptionsInit(t,n)}))}};export{F as default};
