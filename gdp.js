const t=["web","wxwv","minp","alip","baidup","qq","bytedance"],e={autotrack:{type:"boolean",default:!0},compress:{type:"boolean",default:!0},dataCollect:{type:"boolean",default:!0},debug:{type:"boolean",default:!1},hashtag:{type:"boolean",default:!1},touch:{type:"boolean",default:!1},version:{type:"string",default:"1.0.0"},platform:{type:"string",default:"web"},cookieDomain:{type:"string",default:""}},i={enableIdMapping:{type:"boolean",default:!1},gtouchHost:{type:"string",default:""},host:{type:"string",default:""},ignoreFields:{type:"array",default:[]},penetrateHybrid:{type:"boolean",default:!0},scheme:{type:"string",default:location.protocol.indexOf("http")>-1?location.protocol.replace(":",""):"https"},sessionExpires:{type:"number",default:30},performance:{type:"object",default:{monitor:!0,exception:!0}},embeddedIgnore:{type:"array",default:[]}},s={},r=["clearUserId","getGioInfo","getLocation","getOption","init","setDataCollect","setOption","setUserId","track","setGeneralProps","clearGeneralProps","enableDebug","enableHT","setAutotrack","setTrackerHost","setTrackerScheme","setUserAttributes","getVisitorId","getDeviceId","registerPlugins","getPlugins","sendPage","sendVisit","trackTimerStart","trackTimerPause","trackTimerResume","trackTimerEnd","removeTimer","clearTrackTimer"],n=["autotrack","dataCollect","dataSourceId","debug","host","hashtag","scheme"],o={autotrack:"无埋点采集",dataCollect:"数据采集",debug:"调试模式"},a=["send","setConfig","collectImp","setPlatformProfile"],l=["screenHeight","screenWidth"];var d,g,h,c,u,m,p,v="function"==typeof Array.from?Array.from:(g||(g=1,h=function(t){return"function"==typeof t},c=function(t){var e=function(t){var e=Number(t);return isNaN(e)?0:0!==e&&isFinite(e)?(e>0?1:-1)*Math.floor(Math.abs(e)):e}(t);return Math.min(Math.max(e,0),9007199254740991)},u=function(t){if(null!=t){if(["string","number","boolean","symbol"].indexOf(typeof t)>-1)return Symbol.iterator;if("undefined"!=typeof Symbol&&"iterator"in Symbol&&Symbol.iterator in t)return Symbol.iterator;if("@@iterator"in t)return"@@iterator"}},m=function(t,e){if(null!=t&&null!=e){var i=t[e];if(null==i)return;if(!h(i))throw new TypeError(i+" is not a function");return i}},p=function(t){var e=t.next();return!e.done&&e},d=function(t){var e,i,s,r=this,n=arguments.length>1?arguments[1]:void 0;if(void 0!==n){if(!h(n))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(e=arguments[2])}var o=m(t,u(t));if(void 0!==o){i=h(r)?Object(new r):[];var a,l,d=o.call(t);if(null==d)throw new TypeError("Array.from requires an array-like or iterable object");for(s=0;;){if(!(a=p(d)))return i.length=s,i;l=a.value,i[s]=n?n.call(e,l,s):l,s++}}else{var g=Object(t);if(null==t)throw new TypeError("Array.from requires an array-like object - not null or undefined");var v,I=c(g.length);for(i=h(r)?Object(new r(I)):Array(I),s=0;I>s;)v=g[s],i[s]=n?n.call(e,v,s):v,s++;i.length=I}return i}),d);const I=t=>N(["undefined","null"],G(t)),f=t=>"string"===G(t),w=t=>"number"===G(t),S=t=>{const e=Number(t);return e!=e},O=t=>"object"===G(t)&&!I(t),y=t=>"regexp"===G(t),b=t=>"function"===G(t),E=t=>Array.isArray(t)&&"array"===G(t),C=t=>"date"===G(t),_=t=>{try{return q(t)[0]}catch(t){return}},T=t=>{try{const e=q(t);return e[e.length-1]}catch(t){return}},j=(t,e=1)=>E(t)&&w(e)?t.slice(e>0?e:1,t.length):t,k=t=>{if(E(t)){let e=0;const i=[];for(const s of t)s&&!V(s)&&(i[e++]=s);return i}return t},x=(t,e)=>{let i;return E(t)&&t.forEach((t=>{e(t)&&void 0===i&&(i=t)})),i},N=(t,e)=>("array"===G(t)||"string"===G(t))&&t.indexOf(e)>=0,q=v,P=t=>I(t)?"":""+t,D=(t,e)=>"string"==typeof t?t.split(e):t,A=t=>{if(f(t)){const e=D(t,"");return`${_(e).toLowerCase()}${j(e).join("")}`}return t},K=(t,e)=>!!f(t)&&t.slice(0,e.length)===e,U=(t,e)=>{if(f(t)){const{length:i}=t;let s=i;s>i&&(s=i);const r=s;return s-=e.length,s>=0&&t.slice(s,r)===e}return!1},R={}.hasOwnProperty,L=(t,e)=>!I(t)&&R.call(t,e),F=t=>O(t)?Object.keys(t):[],H=(t,e)=>{F(t).forEach((i=>e(t[i],i)))},B=(t,e)=>{const i=F(t);return!(!O(t)||!O(e)||i.length!==F(e).length||N(i.map(((i,s)=>O(t[i])?B(t[i],e[i]):t[i]===e[i])),!1))},$=(t,e)=>{if(!O(t))return!1;try{return"string"===G(e)?delete t[e]:"array"===G(e)?e.map((e=>delete t[e])):(y(e)&&F(t).forEach((i=>{e.test(i)&&$(t,i)})),!0)}catch(t){return!1}},V=t=>E(t)?0===t.length:O(t)?0===F(t).length:!t,G=t=>({}.toString.call(t).slice(8,-1).toLowerCase());var M=Object.freeze({__proto__:null,isNil:I,isString:f,isNumber:w,isNaN:S,isBoolean:t=>"boolean"===G(t),isObject:O,isRegExp:y,isFunction:b,isArray:E,isDate:C,fixed:(t,e)=>w(t)?Number(t.toFixed(w(e)?e:2)):f(t)&&"NaN"!==P(Number(t))?Number(Number(t).toFixed(w(e)?e:2)):t,head:_,last:T,drop:j,dropWhile:(t,e)=>E(t)?t.filter((t=>!e(t))):t,compact:k,find:x,includes:N,arrayFrom:q,toString:P,split:D,lowerFirst:A,upperFirst:t=>{if(f(t)){const e=D(t,"");return`${_(e).toUpperCase()}${j(e).join("")}`}return t},startsWith:K,endsWith:U,hasOwnProperty:R,has:L,keys:F,forEach:H,isEqual:B,get:(t,e,i)=>{let s=t;return O(t)?(e.split(".").forEach((t=>{s=s?s[t]:i})),s):i},unset:$,isEmpty:V,typeOf:G,formatDate:t=>{if(C(t)){const e=t=>10>t?"0"+t:t;return t.getFullYear()+"-"+e(t.getMonth()+1)+"-"+e(t.getDate())+" "+e(t.getHours())+":"+e(t.getMinutes())+":"+e(t.getSeconds())+"."+e(t.getMilliseconds())}return t}});const z=(t,e)=>{console.log("%c [GrowingIO]："+t,{info:"color: #3B82F6;",error:"color: #EF4444;",warn:"color: #F59E0B;",success:"color: #10B981;"}[e]||"")},W=t=>{try{return t()}catch(t){return}},X=t=>{const e={};return O(t)&&H(t,((t,i)=>{var s;const r=P(i).slice(0,100);O(t)?e[r]=X(t):E(t)?(e[r]=t.slice(0,100),"cdp"===(null===(s=window.vds)||void 0===s?void 0:s.gioEnvironment)&&(e[r]=e[r].join("||"))):e[r]=I(t)?"":P(t).slice(0,1e3)})),e},J=(t,e,i,s={})=>{document.addEventListener?t.addEventListener(e,i,Object.assign(Object.assign({},{capture:!0}),s)):t.attachEvent?t.attachEvent("on"+e,i):t["on"+e]=i},Q=(t,e)=>f(t)&&!V(t)&&t.match(/^[a-zA-Z_][0-9a-zA-Z_]{0,100}$/)?e():(z("事件名格式不正确，只能包含数字、字母和下划线，且不能以数字开头，字符总长度不能超过100!","error"),!1);var Z=Object.freeze({__proto__:null,consoleText:z,niceTry:W,limitObject:X,addListener:J,flattenObject:(t={})=>{const e=Object.assign({},t);return F(e).forEach((t=>{O(e[t])?(F(e[t]).forEach((i=>{e[`${t}_${i}`]=P(e[t][i])})),$(e,t)):E(e[t])?(e[t].forEach(((i,s)=>{O(i)?F(i).forEach((r=>{e[`${t}_${s}_${r}`]=P(i[r])})):e[`${t}_${s}`]=P(i)})),$(e,t)):I(e[t])||""===e[t]?$(e,t):e[t]=P(e[t])})),e},eventNameValidate:Q});const Y=t=>f(t)&&t.length>0||w(t)&&t>0,tt=t=>{var e;return t.vdsConfig||t.gioSDKInitialized||(null===(e=window.vds)||void 0===e?void 0:e.gioSDKInitialized)?(z("SDK重复初始化，请检查是否重复加载SDK或接入其他平台SDK导致冲突!","warn"),!1):!(N(["","localhost","127.0.0.1"],location.hostname)&&!window._gr_ignore_local_rule&&(z("当前SDK不允许在本地环境初始化!","warn"),1))},et=t=>!V(k(t))||(z('SDK初始化失败，请使用 gdp("init", "您的GrowingIO项目 accountId", "您项目的 dataSourceId", options); 进行初始化!',"error"),!1),it=t=>{const e=_(t);let i=T(t);return Y(P(e).trim())?(O(i)&&i||(i={}),{projectId:e,userOptions:i}):(z("SDK初始化失败，accountId 参数不合法!","error"),!1)},st=t=>{const e=t[1],i=t[2],s=T(t);return e&&f(e)?O(s)&&s.host?{dataSourceId:e,appId:f(i)?i:"",cdpOptions:s}:(z("SDK初始化失败，未在配置中指定 host!","error"),!1):(z("SDK初始化失败，dataSourceId 参数不合法!","error"),!1)},rt=/^((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})(\.((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})){3}/i,nt=/^(https?:\/\/)|(([a-zA-Z0-9_-])+(\.)?)*(:\d+)?(\/((\.)?(\?)?=?&?[a-zA-Z0-9_-](\?)?)*)*$/i;var ot={},at={}.hasOwnProperty;function lt(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(t){return null}}function dt(t){try{return encodeURIComponent(t)}catch(t){return null}}ot.stringify=function(t,e){e=e||"";var i,s,r=[];for(s in"string"!=typeof e&&(e="?"),t)if(at.call(t,s)){if((i=t[s])||null!=i&&!isNaN(i)||(i=""),s=dt(s),i=dt(i),null===s||null===i)continue;r.push(s+"="+i)}return r.length?e+r.join("&"):""},ot.parse=function(t){for(var e,i=/([^=?#&]+)=?([^&]*)/g,s={};e=i.exec(t);){var r=lt(e[1]),n=lt(e[2]);null===r||null===n||r in s||(s[r]=n)}return s};var gt={name:"gioCustomTracking",method:class{constructor(t){this.growingIO=t,this.getValidResourceItem=t=>{if(t&&O(t)&&t.id&&t.key){const e={id:f(t.id)?t.id:P(t.id),key:f(t.key)?t.key:P(t.key)};return t.attributes&&(e.attributes=t.attributes),e}},this.getDynamicAttributes=t=>(I(t)||F(t).forEach((e=>{b(t[e])?t[e]=t[e]():O(t[e])?$(t,e):E(t[e])||(t[e]=P(t[e]))})),t),this.buildCustomEvent=(t,e,i,s)=>{Q(t,(()=>{const{dataStore:{eventContextBuilder:r,eventConverter:n,currentPage:o}}=this.growingIO;let a=Object.assign({eventType:"CUSTOM",eventName:t,pageShowTimestamp:null==o?void 0:o.time,attributes:X(this.getDynamicAttributes(O(e)&&!V(e)?e:void 0)),resourceItem:X(this.getValidResourceItem(i))},r());V(s)||(a=Object.assign(Object.assign({},a),s)),n(a)}))},this.buildUserAttributesEvent=(t,e)=>{const{dataStore:{eventContextBuilder:i,eventConverter:s}}=this.growingIO;let r=Object.assign({eventType:"LOGIN_USER_ATTRIBUTES",attributes:X(t)},i());V(e)||(r=Object.assign(Object.assign({},r),e)),s(r)}}}};const ht=["gioPerformance"];class ct extends class{constructor(t){var e,i,s,r;this.growingIO=t,this.innerPluginInit=()=>{var t;ht.forEach((t=>{var e;return $(null===(e=this.pluginsContext)||void 0===e?void 0:e.plugins,t)})),F(null===(t=this.pluginsContext)||void 0===t?void 0:t.plugins).forEach((t=>{var e;const{name:i,method:s}=null===(e=this.pluginsContext)||void 0===e?void 0:e.plugins[t];x(this.pluginItems,(t=>t.name===i))||this.pluginItems.push({name:A(i||t),method:s||(t=>{})})})),V(this.pluginItems)||this.installAll()},this.install=(t,e,i)=>{var s,r;const n=e||x(this.pluginItems,(e=>e.name===t));if((null===(s=this.growingIO)||void 0===s?void 0:s.plugins)[t])return z(`重复加载插件 ${t} 或插件重名，已跳过加载!`,"warn"),!1;if(!n)return z(`插件加载失败!不存在名为 ${t} 的插件!`,"error"),!1;try{return(null===(r=this.growingIO)||void 0===r?void 0:r.plugins)[t]=new n.method(this.growingIO,i),"cdp"===this.growingIO.gioEnvironment&&e&&z("加载插件："+t,"info"),!0}catch(t){return z("插件加载异常："+t,"error"),!1}},this.installAll=t=>{(t||this.pluginItems).forEach((e=>this.install(e.name,t?e:void 0,t?null==e?void 0:e.options:void 0)))},this.uninstall=t=>{var e;$(this.pluginItems,t);const i=$(null===(e=this.growingIO)||void 0===e?void 0:e.plugins,t);return i||z(`卸载插件 ${t} 失败!`,"error"),i},this.uninstallAll=()=>{this.pluginItems.forEach((t=>this.uninstall(t.name)))},this.lifeError=(t,e)=>z(`插件执行错误 ${t.name} ${e}`,"error"),this.onComposeBefore=t=>{this.pluginItems.forEach((e=>{var i;const s=null===(i=this.growingIO.plugins[e.name])||void 0===i?void 0:i.onComposeBefore;if(s&&b(s))try{s(t)}catch(t){this.lifeError(e,t)}}))},this.onComposeAfter=t=>{this.pluginItems.forEach((e=>{var i;const s=null===(i=this.growingIO.plugins[e.name])||void 0===i?void 0:i.onComposeAfter;if(s&&b(s))try{s(t)}catch(t){this.lifeError(e,t)}}))},this.onSendBefore=t=>{this.pluginItems.forEach((e=>{var i;const s=null===(i=this.growingIO.plugins[e.name])||void 0===i?void 0:i.onSendBefore;if(s&&b(s))try{s(t)}catch(t){this.lifeError(e,t)}}))},this.onSendAfter=t=>{this.pluginItems.forEach((e=>{var i;const s=null===(i=this.growingIO.plugins[e.name])||void 0===i?void 0:i.onSendAfter;if(s&&b(s))try{s(t)}catch(t){this.lifeError(e,t)}}))},this.pluginsContext={plugins:{}},this.pluginItems=[],null===(e=this.growingIO.emitter)||void 0===e||e.on("onComposeBefore",this.onComposeBefore),null===(i=this.growingIO.emitter)||void 0===i||i.on("onComposeAfter",this.onComposeAfter),null===(s=this.growingIO.emitter)||void 0===s||s.on("onSendBefore",this.onSendBefore),null===(r=this.growingIO.emitter)||void 0===r||r.on("onSendAfter",this.onSendAfter)}}{constructor(t){super(t),this.growingIO=t,this.growingIO.gioSDKFull=!1,this.pluginsContext={plugins:{gioCustomTracking:gt}}}}function ut(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var s in i)t[s]=i[s]}return t}var mt=function t(e,i){function s(t,s,r){if("undefined"!=typeof document){"number"==typeof(r=ut({},i,r)).expires&&(r.expires=new Date(Date.now()+864e5*r.expires)),r.expires&&(r.expires=r.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var n="";for(var o in r)r[o]&&(n+="; "+o,!0!==r[o]&&(n+="="+r[o].split(";")[0]));return document.cookie=t+"="+e.write(s,t)+n}}return Object.create({set:s,get:function(t){if("undefined"!=typeof document&&(!arguments.length||t)){for(var i=document.cookie?document.cookie.split("; "):[],s={},r=0;r<i.length;r++){var n=i[r].split("="),o=n.slice(1).join("=");try{var a=decodeURIComponent(n[0]);if(s[a]=e.read(o,a),t===a)break}catch(t){}}return t?s[t]:s}},remove:function(t,e){s(t,"",ut({},e,{expires:-1}))},withAttributes:function(e){return t(this.converter,ut({},this.attributes,e))},withConverter:function(e){return t(ut({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(i)},converter:{value:Object.freeze(e)}})}({read:function(t){return'"'===t[0]&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});const pt=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})),vt=()=>{var t;const e=!!(null===(t=null===window||void 0===window?void 0:window.navigator)||void 0===t?void 0:t.sendBeacon),i=window.navigator.userAgent;if(i.match(/(iPad|iPhone|iPod)/g)){const t=It(i);return e&&t>13}return e},It=t=>{const e=t.toLowerCase().match(/cpu.*os (.*?) like mac os/i);return!e||2>e.length?0:+e[1].split("_").slice(0,2).join(".")},ft=t=>{mt.set("gioCookie","yes",{domain:t});const e=!!mt.get("gioCookie",{domain:t});return mt.remove("gioCookie",{domain:t}),e},wt=t=>U(t,"_gioenc")?t.slice(0,-7):t,St=t=>S(Number(t))&&W((()=>JSON.parse(t)))||t,Ot={A:1,a:1,Z:1,z:1,"@":1},yt=t=>I(t)?t:W((()=>"gioenc-"+Et(t)))||t,bt=t=>f(t)&&K(t,"gioenc-")&&W((()=>Et(t.replace("gioenc-",""))))||t,Et=t=>(t=t||"").split("").map((t=>Ot[t]?t:Ct(t))).join(""),Ct=t=>{if(/[0-9]/.test(t))return 1^+t;{let e=t.charCodeAt(0);return String.fromCharCode(1^e)}};const _t={};let Tt;const jt=(()=>{let t=window.location.hostname;const e=W((()=>{const e=t.split("."),i=T(e);if("localhost"!==t&&(S(Number(i))||0>Number(i)||Number(i)>255))return["."+e.slice(-2).join("."),"."+e.slice(-3).join(".")]}))||[t];let i="";return e.some((t=>!!ft(t)&&(i=t,!0))),i})();Tt=!N(["","localhost","127.0.0.1"],window.location.hostname)&&N(["http:","https:"],window.location.protocol)&&jt?new class{constructor(t){this.domain=t,this.getItem=t=>St(bt(mt.get(wt(t)))),this.setItem=(t,e,i)=>{let s;s=f(e)?e.length?U(t,"_gioenc")?yt(e):e:"":JSON.stringify(e),mt.set(wt(t),s,{expires:i?new Date(i):3650,domain:this.domain})},this.removeItem=t=>{mt.remove(wt(t),{domain:this.domain})},this.hasItem=t=>N(F(mt.get()),wt(t)),this.getKeys=()=>F(mt.get()),this.type="Cookie"}}(jt):(t=>{try{const t=window.localStorage,e="__storage_test__";return t.setItem(e,e),t.removeItem(e),!0}catch(t){return!1}})()?new class{constructor(){this.getItem=t=>{const e=W((()=>JSON.parse(localStorage.getItem(wt(t))||"")))||{};return O(e)&&e.expiredAt>+Date.now()?St(bt(e.value)):void 0},this.setItem=(t,e,i)=>{const s=null!=i?i:+new Date(9999,12);localStorage.setItem(wt(t),JSON.stringify({value:f(e)&&e.length&&U(t,"_gioenc")?yt(e):e,expiredAt:s}))},this.removeItem=t=>localStorage.removeItem(wt(t)),this.hasItem=t=>!!localStorage.getItem(wt(t)),this.getKeys=()=>q(Array(localStorage.length)).map(((t,e)=>localStorage.key(e))),this.type="localStorage"}}:new class{constructor(){this.getItem=t=>{const e=W((()=>JSON.parse(_t[wt(t)]||"")));return O(e)&&e.expiredAt>+Date.now()?St(bt(e.value)):void 0},this.setItem=(t,e,i)=>{const s=null!=i?i:+new Date(9999,12);_t[wt(t)]=JSON.stringify({value:f(e)&&e.length?yt(e):e,expiredAt:s})},this.removeItem=t=>$(_t,wt(t)),this.hasItem=t=>L(_t,wt(t)),this.getKeys=()=>F(_t),this.type="memory"}};var kt=Tt;class xt{constructor(t){var e;this.growingIO=t;const{projectId:i}=this.growingIO.vdsConfig,{getItem:s,setItem:r,getKeys:n,removeItem:o}=this.growingIO.storage;this.getItem=s,this.setItem=r,this.getKeys=n,this.removeItem=o,this.sIdStorageName=i+"_gdp_session_id",this.uidStorageName="gdp_user_id_gioenc",this.userIdStorageName=i+"_gdp_cs1_gioenc",this.userKeyStorageName=i+"_gdp_user_key_gioenc",this.gioIdStorageName=i+"_gdp_gio_id_gioenc",null===(e=this.growingIO.emitter)||void 0===e||e.on("SESSIONID_UPDATE",(()=>{this.growingIO.gioSDKInitialized&&(this.growingIO.dataStore.sendVisit(!0),this.growingIO.dataStore.sendPage(!0))}))}get sessionId(){return this.getItem(this.sIdStorageName)||(this.sessionId=pt(),this.sessionId)}set sessionId(t){var e;t||(t=pt());const i=this.getItem(this.sIdStorageName)||this.prevSessionId,{sessionExpires:s=30}=this.growingIO.vdsConfig;this.setItem(this.sIdStorageName,t,+Date.now()+60*s*1e3),i!==t&&(this.getKeys().filter((t=>/.+_gdp_session_id_.+/.test(t))).forEach((t=>{this.removeItem(t)})),null===(e=this.growingIO.emitter)||void 0===e||e.emit("SESSIONID_UPDATE",{newSessionId:t,oldSessionId:i})),this.prevSessionId=t}get uid(){return this.getItem(this.uidStorageName)||(this.uid=pt(),this.uid)}set uid(t){var e;const i=this.getItem(this.uidStorageName)||this.prevUId;this.setItem(this.uidStorageName,t),i!==t&&(null===(e=this.growingIO.emitter)||void 0===e||e.emit("UID_UPDATE",{newUId:t,oldUId:i})),this.prevUId=t}get userId(){return this.getItem(this.userIdStorageName)||""}set userId(t){var e;const i=this.getItem(this.userIdStorageName)||this.prevUserId;this.setItem(this.userIdStorageName,t),i!==t&&(null===(e=this.growingIO.emitter)||void 0===e||e.emit("USERID_UPDATE",{newUserId:t,oldUserId:i,userKey:this.userKey})),t&&(this.gioId=t),this.prevUserId=t}get userKey(){return this.getItem(this.userKeyStorageName)||""}set userKey(t){var e;const i=this.getItem(this.userKeyStorageName)||this.prevUserKey;this.setItem(this.userKeyStorageName,t),i!==t&&(null===(e=this.growingIO.emitter)||void 0===e||e.emit("USERKEY_UPDATE",{newUserKey:t,oldUserKey:i,userId:this.userId})),this.prevUserKey=t}get gioId(){return this.getItem(this.gioIdStorageName)||""}set gioId(t){var e;const i=this.getItem(this.gioIdStorageName)||this.prevGioId;this.setItem(this.gioIdStorageName,t),i!==t&&(null===(e=this.growingIO.emitter)||void 0===e||e.emit("GIOID_UPDATE",{newGioId:t,oldGioId:i})),this.prevGioId=t}}class Nt{constructor(t){this.growingIO=t,this.main=()=>{var t;const{sdkVersion:e,useEmbeddedInherit:i,vdsConfig:s,userStore:r,dataStore:n,trackingId:o}=this.growingIO,{path:a,query:l}=n.currentPage;let d={appVersion:s.version,dataSourceId:s.dataSourceId,deviceId:r.uid,domain:i?s.appId:window.location.host,gioId:r.gioId,language:navigator.language,path:a,platform:s.platform,query:l,referralPage:(null===(t=n.lastPageEvent)||void 0===t?void 0:t.referralPage)||"",screenHeight:window.screen.height,screenWidth:window.screen.width,sdkVersion:e,sessionId:r.sessionId,timestamp:+Date.now(),title:document.title.slice(0,255),userId:r.userId};if(s.enableIdMapping&&(d.userKey=r.userKey),V(s.ignoreFields)||s.ignoreFields.forEach((t=>{$(d,t)})),i&&!V(this.minpExtraParams)){const t=Object.assign({},d);H(Object.assign(Object.assign({},d),this.minpExtraParams),((e,i)=>{var r;N(s.embeddedIgnore,i)?(d[i]=t[i],"domain"===i&&(d[i]=window.location.host)):d[i]=null!==(r=this.minpExtraParams[i])&&void 0!==r?r:d[i]}))}return d.trackingId=o,d},this.minpExtraParams={}}}class qt{constructor(t){this.growingIO=t,this.parsePage=()=>{const{hashtag:t}=this.growingIO.vdsConfig,e=location.pathname,i=location.search,s=location.hash,r=s.indexOf("?");this.domain=window.location.host,this.title=document.title.slice(0,255),this.time=+Date.now(),this.path=e,this.query=i,t&&(r>-1?(this.path+=s.slice(0,r),this.query=this.query+"&"+s.slice(r+1)):this.path+=s),this.query&&N(["?","&"],this.query.charAt(0))&&(this.query=this.query.slice(1))},this._getNoHashHref=()=>{const{protocol:t,host:e,pathname:i,search:s}=window.location;return`${t}://${e}${i}${s}`},this.pageListener=()=>{const{hashtag:t}=this.growingIO.vdsConfig;let e=window.location.href,i=this.lastHref;t||(e=this._getNoHashHref(),i=this.lastNoHashHref),i!==e&&(this.parsePage(),this.buildPageEvent())},this.hookHistory=()=>{const t=window.history.pushState,e=window.history.replaceState,i=this;t&&W((()=>window.history.pushState=function(){t.apply(window.history,arguments),setTimeout(i.pageListener)})),e&&W((()=>window.history.replaceState=function(){e.apply(window.history,arguments),setTimeout(i.pageListener)})),J(window,"popstate",this.pageListener);const{hashtag:s}=this.growingIO.vdsConfig;s&&J(window,"hashchange",this.pageListener)},this.buildPageEvent=t=>{const{dataStore:{lastPageEvent:e,eventContextBuilder:i,eventConverter:s}}=this.growingIO;let r=Object.assign(Object.assign({eventType:"PAGE"},i()),{protocolType:location.protocol.substring(0,location.protocol.length-1),referralPage:(null==e?void 0:e.path)===this.path&&(null==e?void 0:e.query)===this.query?null==e?void 0:e.referralPage:(null==e?void 0:e.path)?this.lastHref:document.referrer});V(t)||(r=Object.assign(Object.assign({},r),t)),r.timestamp=this.time,s(r),this.lastHref=window.location.href,this.lastNoHashHref=this._getNoHashHref(),this.lastLocation=Object.assign({},window.location)},this.title=document.title.slice(0,255),this.lastLocation=Object.assign({},window.location)}}class Pt extends class{constructor(r){var a,d;this.growingIO=r,this.ALLOW_SETTING=Object.assign(Object.assign({},e),"saas"===this.growingIO.gioEnvironment?s:i),this.allowOptKeys=Object.keys(this.ALLOW_SETTING),this.trackTimers={},this.initStorageId=()=>{const t=this.growingIO.storage.getItem(this.seqStorageIdName)||{};let e=Object.assign({},t);$(e,"globalKey"),e=O(e)&&!I(e)?e:{},this._esid={},F(e).forEach((t=>{this._esid[t]=S(Number(e[t]))||e[t]>=1e9||1>e[t]?1:e[t]})),B(e,this._esid)||this.setSequenceIds("esid",this._esid);const i=Number(t.globalKey);this._gsid=S(i)||i>=1e9||1>i?1:i,i!==this._gsid&&this.setSequenceIds("gsid",this._gsid)},this.setSequenceIds=(t,e)=>{let i=this.growingIO.storage.getItem(this.seqStorageIdName)||{};"gsid"===t?i.globalKey=e:i=Object.assign(Object.assign({},i),e),this.growingIO.storage.setItem(this.seqStorageIdName,i)},this.initOptions=e=>{var i,s,r,n,a,d,g;const{projectId:h,dataSourceId:c,appId:u}=e;this.initialDataSourceId=c;const m={};this.allowOptKeys.forEach((i=>{const s=this.ALLOW_SETTING[i].type;let r=E(s)?!N(s,G(e[i])):G(e[i])!==s;"platform"!==i||N(t,e[i])||(r=!0),r?m[i]=this.ALLOW_SETTING[i].default:"ignoreFields"===i?m.ignoreFields=e.ignoreFields.filter((t=>N(l,t))):(m[i]=e[i],N(["dataCollect","autotrack"],i)&&(m[i]||z("已关闭"+o[i],"info")))})),m.sessionExpires=Math.round(m.sessionExpires),(S(m.sessionExpires)||1>m.sessionExpires||m.sessionExpires>360)&&(m.sessionExpires=30),"Cookie"===this.growingIO.storage.type&&m.cookieDomain&&ft(m.cookieDomain)&&(this.growingIO.storage.domain=m.cookieDomain),this.growingIO.vdsConfig=Object.assign(Object.assign(Object.assign({},null!==(i=window.vds)&&void 0!==i?i:{}),m),{projectId:h,dataSourceId:c,appId:u,performance:{monitor:null===(r=null===(s=m.performance)||void 0===s?void 0:s.monitor)||void 0===r||r,exception:null===(a=null===(n=m.performance)||void 0===n?void 0:n.exception)||void 0===a||a,network:null!==(g=null===(d=m.performance)||void 0===d?void 0:d.network)&&void 0!==g&&g}}),window.vds=this.growingIO.vdsConfig,this.seqStorageIdName=h+"_gdp_sequence_ids"},this.setOption=(t,e)=>{var i;const{vdsConfig:s,callError:r,uploader:o,emitter:a}=this.growingIO,l=f(t)&&N(n,t),d=l&&typeof e===((null===(i=this.ALLOW_SETTING[t])||void 0===i?void 0:i.type)||"string"),g=Object.assign({},s);return l&&d?(s[t]=e,"dataCollect"===t&&g.dataCollect!==e&&(e?(this.sendVisit(!0),this.sendPage()):this.growingIO.clearTrackTimer()),N(["host","scheme"],t)&&(null==o||o.generateHost()),null==a||a.emit("OPTION_CHANGE",{optionName:t,optionValue:e}),window.vds[t]=e,!0):(r("setOption > "+t),!1)},this.getOption=t=>{const{vdsConfig:e,callError:i}=this.growingIO;return t&&L(e,P(t))?e[P(t)]:I(t)?Object.assign({},e):void i("getOption > "+t)},this.sendVisit=t=>{const{userStore:{sessionId:e},vdsConfig:{projectId:i,dataCollect:s},storage:r}=this.growingIO;if(s){const s=`${i}_gdp_session_id_${e}`,n=r.getItem(s);!t&&N([!0,"true"],n)||(this.buildVisitEvent(),r.setItem(s,!0))}},this.buildVisitEvent=t=>{const{dataStore:{eventContextBuilder:e,eventConverter:i}}=this.growingIO;let s=Object.assign(Object.assign({eventType:"VISIT"},e()),{referral:this.lastVisitEvent.referral,referralPage:this.lastPageEvent.referralPage});V(t)||(s.session=(null==t?void 0:t.session)||s.session,s.trackingId=null==t?void 0:t.trackingId,s=Object.assign(Object.assign({},s),t)),this.lastVisitEvent.path&&(s.path=this.lastVisitEvent.path,s.query=this.lastVisitEvent.query),i(s)},this.sendPage=t=>{t&&this.currentPage.parsePage(),this.currentPage.buildPageEvent()},this.buildErrorEvent=t=>{const{dataStore:{eventContextBuilder:e,eventConverter:i}}=this.growingIO;i(Object.assign({eventType:"CUSTOM",pageShowTimestamp:this.currentPage.time,eventName:"onError",attributes:t},e()))},this.currentPage=new qt(this.growingIO),this.eventContextBuilderInst=new Nt(this.growingIO),this.eventContextBuilder=this.eventContextBuilderInst.main,this.generalProps={},this.lastVisitEvent={referralPage:document.referrer},null===(a=this.growingIO.emitter)||void 0===a||a.on("onComposeAfter",(({composedEvent:t})=>{"VISIT"!==t.eventType&&"vst"!==t.t||t.trackingId!==this.growingIO.trackingId||(this.lastVisitEvent=t)})),this.lastPageEvent={},null===(d=this.growingIO.emitter)||void 0===d||d.on("onComposeAfter",(({composedEvent:t})=>{"PAGE"!==t.eventType&&"page"!==t.t||t.trackingId!==this.growingIO.trackingId||(this.lastPageEvent=t)}))}get esid(){const t=this.growingIO.storage.getItem(this.seqStorageIdName)||{};let e=Object.assign({},t);return $(e,"globalKey"),e=O(e)&&!I(e)?e:{},this._esid={},F(e).forEach((t=>{this._esid[t]=S(Number(e[t]))||e[t]>=1e9||1>e[t]?1:e[t]})),this._esid}set esid(t){const e={};F(t).forEach((i=>{e[i]=S(t[i])||t[i]>=1e9||1>t[i]?1:t[i]})),B(this._esid,e)||(this._esid=e,this.setSequenceIds("esid",this._esid))}get gsid(){const t=this.growingIO.storage.getItem(this.seqStorageIdName)||{},e=Number(t.globalKey);return this._gsid=S(e)||e>=1e9||1>e?1:e,this._gsid}set gsid(t){S(Number(t))||t>=1e9||1>t?this._gsid=1:this._gsid=t,this.setSequenceIds("gsid",this._gsid)}}{constructor(t){super(t),this.growingIO=t,this.eventConverter=t=>{var e;const{vdsConfig:i,dataStore:s,uploader:r}=this.growingIO;if(i.dataCollect){t.trackingId===this.growingIO.trackingId&&(t.globalSequenceId=s.gsid,t.eventSequenceId=s.esid[t.eventType]||1);const i={};H(t,((t,e)=>{var s;if("element"===e){const e=null!==(s=_(t))&&void 0!==s?s:{};H(e,((t,e)=>{V(t)&&0!==t||(i[e]=t)}))}else(V(t)||I(t))&&0!==t||(i[e]=t)})),t.trackingId===this.growingIO.trackingId&&(this.growingIO.dataStore.gsid+=1,this.growingIO.dataStore.esid=Object.assign(Object.assign({},this.growingIO.dataStore.esid),{[i.eventType]:(this.growingIO.dataStore.esid[i.eventType]||1)+1})),null===(e=this.growingIO.emitter)||void 0===e||e.emit("onComposeAfter",{composedEvent:Object.assign({},i)}),t.trackingId===this.growingIO.trackingId&&r.commitRequest(i)}}}}class Dt extends class{constructor(t){this.growingIO=t,this.commitRequest=t=>{const e=Object.assign({},t);this.requestQueue.push(Object.assign(Object.assign({},e),{requestType:vt()?"Beacon":"XHR"})),this.initiateRequest()},this.initiateRequest=()=>{var t,e;if([...this.requestQueue].length>0&&this.requestingNum<this.requestLimit){const{vdsConfig:i,emitter:s,plugins:r,useHybridInherit:n}=this.growingIO;if(this.requestQueue=[...this.requestQueue].filter((t=>(this.retryIds[t.globalSequenceId||t.esid]||0)<=this.retryLimit)),V(this.requestQueue))return;const o=this.requestQueue.shift(),{requestType:a}=o;if(null==s||s.emit("onSendBefore",{requestData:o}),$(o,["requestType","trackingId"]),i.debug&&console.log("[GrowingIO Debug]:",JSON.stringify(o,null,2).replace(/\"/g,(()=>{const t=window.navigator.userAgent;return/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(t)&&!/chrome\/(\d+\.\d+)/i.test(t)})()?"":'"')),this.requestingNum+=1,n)return this.requestSuccessFn(o),!1;let l=Object.assign({},o);switch(i.compress&&(null===(t=null==r?void 0:r.gioCompress)||void 0===t?void 0:t.compressToUint8Array)?(this.compressType="1",l=null===(e=null==r?void 0:r.gioCompress)||void 0===e?void 0:e.compressToUint8Array(JSON.stringify([l]))):(this.compressType="0",l=JSON.stringify([l])),a){case"Beacon":default:this.sendByBeacon(o,l);break;case"XHR":this.sendByXHR(o,l);break;case"Image":this.sendByImage(o,l)}}},this.generateURL=()=>`${this.requestURL}?stm=${+Date.now()}&compress=${this.compressType}`,this.sendByBeacon=(t,e)=>{navigator.sendBeacon(this.generateURL(),e)?this.requestSuccessFn(t):this.requestFailFn(t,"Beacon")},this.sendByXHR=(t,e)=>{var i;const s=N(["unload","beforeunload","pagehide"],null===(i=null===window||void 0===window?void 0:window.event)||void 0===i?void 0:i.type),r=new XMLHttpRequest;if(r)return r.open("POST",this.generateURL(),s),r.onreadystatechange=()=>{4===r.readyState&&204===r.status?this.requestSuccessFn(t):this.requestFailFn(t,"XHR")},r.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),void r.send(e);if(null===window||void 0===window?void 0:window.XDomainRequest){const i=new window.XDomainRequest;i.open("POST",this.generateURL().replace("https://","http://"),s),i.onload=()=>{204===i.status?this.requestSuccessFn(t):this.requestFailFn(t,"XHR")},i.onerror=i.ontimeout=()=>{this.requestFailFn(t,"XHR")},i.send(e)}},this.sendByImage=(t,e)=>{const i=`${this.generateURL()}&data=${e}`;let s=document.createElement("img");s.width=1,s.height=1,s.onload=()=>{this.requestSuccessFn(t),this.clearImage(s)},s.onerror=s.onabort=()=>{this.requestFailFn(t,"Image"),this.clearImage(s)},s.src=i},this.clearImage=t=>{t.src="",t.onload=()=>{},t.onerror=t.onerabort=()=>{},t=null},this.requestSuccessFn=t=>{var e;this.requestingNum-=1;const i=t.globalSequenceId||t.esid||-1;this.retryIds[i]&&(this.retryIds[i]=0),this.growingIO.userStore.sessionId=this.growingIO.userStore.sessionId,null===(e=this.growingIO.emitter)||void 0===e||e.emit("onSendAfter",{requestData:t}),this.initiateRequest()},this.requestFailFn=(t,e)=>{this.requestingNum-=1;const i=t.globalSequenceId||t.esid||-1;this.retryIds[i]||(this.retryIds[i]=0),this.retryIds[i]+=1;const s=this.requestQueue.some((e=>e.globalSequenceId===t.globalSequenceId&&e.esid===t.esid));let r=e;this.retryIds[i]<this.retryLimit+1||(r="Beacon"===e?"XHR":"XHR"===e?"Image":void 0,this.retryIds[i]=0),!s&&r&&this.requestQueue.push(Object.assign(Object.assign({},t),{requestType:r}))},this.requestQueue=[],this.requestLimit=10,this.requestTimeout=5e3,this.retryLimit=1,this.retryIds={},this.requestingNum=0,this.requestURL=""}}{constructor(t){super(t),this.growingIO=t,this.generateHost=()=>{let{scheme:t,host:e="",projectId:i}=this.growingIO.vdsConfig;t?U(P(t),"://")||(t+="://"):t=(location.protocol.indexOf("http")>-1?location.protocol.replace(":",""):"https")+"//",K(e,"http")&&(e=e.substring(e.indexOf("://")+(U(P(t),"://")?3:0))),this.requestURL=`${t}${e}/v3/projects/${i}/collect`},this.requestURL="",this.generateHost()}}class At extends class{constructor(){var t;this.trackingId="g0",this.init=t=>{var e,i,s,r,n,o;z("Gio Web SDK 初始化中...","info");const{initOptions:a,currentPage:l,sendVisit:d,sendPage:g}=this.dataStore;a(t),this.useEmbeddedInherit=null===(i=null===(e=this.plugins)||void 0===e?void 0:e.gioEmbeddedAdapter)||void 0===i?void 0:i.main(t),this.useHybridInherit=null===(r=null===(s=this.plugins)||void 0===s?void 0:s.gioHybridAdapter)||void 0===r?void 0:r.main(t),null==this||this.initCallback(),l.hookHistory(),l.parsePage(),null===(n=this.emitter)||void 0===n||n.emit("SDK_INITIALIZED",this),z("Gio Web SDK 初始化完成！","success"),this.useEmbeddedInherit||d(),g(),this.gioSDKInitialized=!0,this.vdsConfig.gioSDKInitialized=!0,window.vds.gioSDKInitialized=!0,null===(o=this.emitter)||void 0===o||o.emit("SDK_INITIALIZED_COMPLATE",this)},this.setOption=(t,e)=>{if(N(n,t)){const i=this.dataStore.setOption(t,e);return i&&o[t]&&z(`已${e?"开启":"关闭"}${o[t]}`,"info"),i}return z(`不存在可修改的配置项：${t}，请检查后重试!`,"warn"),!1},this.getOption=t=>this.dataStore.getOption(t),this.setGeneralProps=t=>{O(t)&&!V(t)?(this.dataStore.generalProps=Object.assign(Object.assign({},this.dataStore.generalProps),t),F(this.dataStore.generalProps).forEach((t=>{N([void 0,null],this.dataStore.generalProps[t])&&(this.dataStore.generalProps[t]="")}))):this.callError("setGeneralProps")},this.clearGeneralProps=t=>{E(t)&&!V(t)?t.forEach((t=>{$(this.dataStore.generalProps,t)})):this.dataStore.generalProps={}},this.reissuePage=()=>{this.dataStore.sendPage()},this.notRecommended=()=>z("不推荐的方法使用，建议使用 gio('setOption', [optionName], [value])!","info"),this.callError=(t,e=!0,i="参数不合法")=>z(`${e?"调用":"设置"} ${t} 失败，${i}!`,"warn"),this.gioEnvironment="cdp",this.sdkVersion="3.8.1",this.utils=Object.assign(Object.assign(Object.assign({},M),Z),{qs:ot}),this.emitter={all:t=t||new Map,on:function(e,i){var s=t.get(e);s?s.push(i):t.set(e,[i])},off:function(e,i){var s=t.get(e);s&&(i?s.splice(s.indexOf(i)>>>0,1):t.set(e,[]))},emit:function(e,i){var s=t.get(e);s&&s.slice().map((function(t){t(i)})),(s=t.get("*"))&&s.slice().map((function(t){t(e,i)}))}},this.gioSDKInitialized=!1,this.storage=kt,this.plugins=new ct(this),this.plugins.innerPluginInit()}}{constructor(){super(),this.registerPlugins=t=>{E(t)?(t.forEach(((e,i)=>{var s,r;V(e)||I(e)?z("插件不合法，跳过加载!","warn"):(null===(s=e.js)||void 0===s?void 0:s.default)&&(t[i]=Object.assign(Object.assign({},null===(r=e.js)||void 0===r?void 0:r.default),{options:e.options}))})),t=k(t),this.plugins.pluginItems=[...this.plugins.pluginItems,...t],this.plugins.installAll(t)):z("插件注册失败，请检查!","error")},this.getPlugins=()=>this.plugins.pluginItems,this.initCallback=()=>{var t,e;this.userStore=new xt(this),this.uploader=new Dt(this),null===(e=null===(t=this.plugins)||void 0===t?void 0:t.gioEventAutoTracking)||void 0===e||e.main(),this.vdsConfig.enableIdMapping||(this.userStore.userKey="")},this.setTrackerScheme=t=>{N(["http","https"],t)?(this.dataStore.setOption("scheme",t),this.notRecommended()):this.callError("scheme",!1)},this.setTrackerHost=t=>{rt.test(t)||nt.test(t)?(this.dataStore.setOption("host",t),this.notRecommended()):this.callError("host",!1)},this.setDataCollect=t=>{this.setOption("dataCollect",!!t),this.notRecommended()},this.setAutotrack=t=>{this.setOption("autotrack",!!t),this.notRecommended()},this.enableDebug=t=>{this.setOption("debug",!!t),this.notRecommended()},this.enableHT=t=>{this.setOption("hashtag",!!t),this.notRecommended()},this.getVisitorId=()=>this.userStore.uid,this.getDeviceId=()=>this.userStore.uid,this.setUserAttributes=(t,e)=>{var i,s;!V(t)&&O(t)?null===(s=null===(i=this.plugins)||void 0===i?void 0:i.gioCustomTracking)||void 0===s||s.buildUserAttributesEvent(t,e):this.callError("setUserAttributes")},this.setUserId=(t,e)=>{if(Y(P(t).trim())){const i=this.userStore.gioId;this.vdsConfig.enableIdMapping&&(this.userStore.userKey=!I(e)&&P(e).length>0?P(e).slice(0,1e3):""),t=P(t).slice(0,1e3),this.userStore.userId=t,i&&i!==t&&(this.userStore.sessionId=""),i||i===t||this.dataStore.sendVisit(!0)}else this.clearUserId(),this.callError("setUserId")},this.clearUserId=()=>{this.userStore.userId="",this.userStore.userKey=""},this.track=(t,e,i,s)=>{var r,n;((null===(n=null===(r=this.plugins)||void 0===r?void 0:r.gioCustomTracking)||void 0===n?void 0:n.buildCustomEvent)||function(){})(t,Object.assign(Object.assign({},this.dataStore.generalProps),O(e)&&!V(e)?e:{}),i,s)},this.sendPage=t=>this.dataStore.currentPage.buildPageEvent(t),this.sendVisit=t=>this.dataStore.buildVisitEvent(t),this.trackTimerStart=(t,e)=>{this.vdsConfig.dataCollect&&Q(t,(()=>{const i=pt();b(e)?(this.dataStore.trackTimers[i]={eventName:t,leng:0,start:+Date.now()},e(i)):z("回调方法不合法，返回timerId失败!")}))},this.trackTimerPause=t=>{if(t&&this.dataStore.trackTimers[t]){const e=this.dataStore.trackTimers[t];e.start&&(e.leng=e.leng+(+Date.now()-e.start)),e.start=0}},this.trackTimerResume=t=>{if(t&&this.dataStore.trackTimers[t]){const e=this.dataStore.trackTimers[t];0===e.start&&(e.start=+Date.now())}},this.trackTimerEnd=(t,e)=>{if(this.vdsConfig.dataCollect){const i=864e5;if(t&&this.dataStore.trackTimers[t]){const s=this.dataStore.trackTimers[t];if(0!==s.start){const t=+Date.now()-s.start;s.leng=t>0?s.leng+t:0}this.track(s.eventName,Object.assign(Object.assign({},e),{eventDuration:s.leng>i?0:s.leng/1e3})),this.removeTimer(t)}else z("未查找到对应的计时器，请检查!","error")}},this.removeTimer=t=>{t&&this.dataStore.trackTimers[t]&&delete this.dataStore.trackTimers[t]},this.clearTrackTimer=()=>{this.dataStore.trackTimers={}},this.dataStore=new Pt(this)}}let Kt;!function(){var t,e,i,s;if(null===(t=window.vds)||void 0===t?void 0:t.gioSDKInstalled)return Kt=window.gdp,void z("SDK重复加载，请检查是否重复加载SDK或接入其他平台SDK导致冲突!","warn");window.vds=Object.assign(Object.assign({},window.vds),{gioSDKInstalled:!0});const n=new At;Kt=function(){var t;const e=arguments[0];if(f(e)&&N(r,e)&&n[e]){const t=j(q(arguments));if("init"===e){if(!tt(n))return;if(!et(t))return;const e=it(t);if(!e)return;const i=st(t);if(!i)return;const{projectId:s}=e,{dataSourceId:r,appId:o,cdpOptions:a}=i;n.init(Object.assign(Object.assign({},a),{projectId:s,dataSourceId:r,appId:o}))}else if("registerPlugins"===e)n.registerPlugins(t[0]);else{if(n.gioSDKInitialized&&n.vdsConfig)return n[e](...t);z("SDK未初始化!","error")}}else N(a,e)?z(`方法 ${P(e)} 已被弃用，请移除!`,"warn"):z(`不存在名为 ${P(e)} 的方法调用!`,"error");window.vds=Object.assign(Object.assign({},window.vds),{_gr_ignore_local_rule:null!==(t=window._gr_ignore_local_rule)&&void 0!==t&&t,gioEnvironment:"cdp",gioSDKVersion:n.sdkVersion,gioSDKFull:n.gioSDKFull,canIUse:t=>N(r,t)&&n[t]})};const o=null===(e=null===window||void 0===window?void 0:window.gdp)||void 0===e?void 0:e.q,l=null===(i=null===window||void 0===window?void 0:window.gdp)||void 0===i?void 0:i.e,d=null===(s=null===window||void 0===window?void 0:window.gdp)||void 0===s?void 0:s.ef;window.gdp=Kt,window.gdp.e=l,window.gdp.ef=d,E(o)&&!V(o)&&o.forEach((t=>{Kt.apply(null,t)}))}();var Ut=Kt;export{Ut as default};
